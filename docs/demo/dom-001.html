<!DOCTYPE html>

<html>
<head>
  <title>Demo DOM 001</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
  <link rel="stylesheet" media="all" href="../docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page_wrapper">
            <div id="jump_page">
              
                
                <a class="source" href="canvas-001.html">
                  ./demo/canvas-001.js
                </a>
              
                
                <a class="source" href="canvas-002.html">
                  ./demo/canvas-002.js
                </a>
              
                
                <a class="source" href="canvas-003.html">
                  ./demo/canvas-003.js
                </a>
              
                
                <a class="source" href="canvas-004.html">
                  ./demo/canvas-004.js
                </a>
              
                
                <a class="source" href="canvas-005.html">
                  ./demo/canvas-005.js
                </a>
              
                
                <a class="source" href="canvas-006.html">
                  ./demo/canvas-006.js
                </a>
              
                
                <a class="source" href="canvas-007.html">
                  ./demo/canvas-007.js
                </a>
              
                
                <a class="source" href="canvas-008.html">
                  ./demo/canvas-008.js
                </a>
              
                
                <a class="source" href="canvas-009.html">
                  ./demo/canvas-009.js
                </a>
              
                
                <a class="source" href="canvas-010.html">
                  ./demo/canvas-010.js
                </a>
              
                
                <a class="source" href="canvas-011.html">
                  ./demo/canvas-011.js
                </a>
              
                
                <a class="source" href="canvas-012.html">
                  ./demo/canvas-012.js
                </a>
              
                
                <a class="source" href="canvas-013.html">
                  ./demo/canvas-013.js
                </a>
              
                
                <a class="source" href="canvas-014.html">
                  ./demo/canvas-014.js
                </a>
              
                
                <a class="source" href="canvas-015.html">
                  ./demo/canvas-015.js
                </a>
              
                
                <a class="source" href="canvas-016.html">
                  ./demo/canvas-016.js
                </a>
              
                
                <a class="source" href="canvas-017.html">
                  ./demo/canvas-017.js
                </a>
              
                
                <a class="source" href="canvas-018.html">
                  ./demo/canvas-018.js
                </a>
              
                
                <a class="source" href="canvas-019.html">
                  ./demo/canvas-019.js
                </a>
              
                
                <a class="source" href="canvas-020.html">
                  ./demo/canvas-020.js
                </a>
              
                
                <a class="source" href="canvas-021.html">
                  ./demo/canvas-021.js
                </a>
              
                
                <a class="source" href="canvas-022.html">
                  ./demo/canvas-022.js
                </a>
              
                
                <a class="source" href="canvas-023.html">
                  ./demo/canvas-023.js
                </a>
              
                
                <a class="source" href="canvas-024.html">
                  ./demo/canvas-024.js
                </a>
              
                
                <a class="source" href="canvas-025.html">
                  ./demo/canvas-025.js
                </a>
              
                
                <a class="source" href="canvas-026.html">
                  ./demo/canvas-026.js
                </a>
              
                
                <a class="source" href="canvas-027.html">
                  ./demo/canvas-027.js
                </a>
              
                
                <a class="source" href="canvas-028.html">
                  ./demo/canvas-028.js
                </a>
              
                
                <a class="source" href="canvas-029.html">
                  ./demo/canvas-029.js
                </a>
              
                
                <a class="source" href="canvas-030.html">
                  ./demo/canvas-030.js
                </a>
              
                
                <a class="source" href="canvas-031.html">
                  ./demo/canvas-031.js
                </a>
              
                
                <a class="source" href="component-001.html">
                  ./demo/component-001.js
                </a>
              
                
                <a class="source" href="component-002.html">
                  ./demo/component-002.js
                </a>
              
                
                <a class="source" href="component-003.html">
                  ./demo/component-003.js
                </a>
              
                
                <a class="source" href="component-004.html">
                  ./demo/component-004.js
                </a>
              
                
                <a class="source" href="component-005.html">
                  ./demo/component-005.js
                </a>
              
                
                <a class="source" href="core-001.html">
                  ./demo/core-001.js
                </a>
              
                
                <a class="source" href="dom-001.html">
                  ./demo/dom-001.js
                </a>
              
                
                <a class="source" href="dom-002.html">
                  ./demo/dom-002.js
                </a>
              
                
                <a class="source" href="dom-003.html">
                  ./demo/dom-003.js
                </a>
              
                
                <a class="source" href="dom-004.html">
                  ./demo/dom-004.js
                </a>
              
                
                <a class="source" href="dom-005.html">
                  ./demo/dom-005.js
                </a>
              
                
                <a class="source" href="dom-006.html">
                  ./demo/dom-006.js
                </a>
              
                
                <a class="source" href="dom-007.html">
                  ./demo/dom-007.js
                </a>
              
                
                <a class="source" href="dom-008.html">
                  ./demo/dom-008.js
                </a>
              
                
                <a class="source" href="dom-009.html">
                  ./demo/dom-009.js
                </a>
              
                
                <a class="source" href="dom-010.html">
                  ./demo/dom-010.js
                </a>
              
                
                <a class="source" href="dom-011.html">
                  ./demo/dom-011.js
                </a>
              
                
                <a class="source" href="dom-012.html">
                  ./demo/dom-012.js
                </a>
              
                
                <a class="source" href="dom-013.html">
                  ./demo/dom-013.js
                </a>
              
                
                <a class="source" href="dom-014a.html">
                  ./demo/dom-014a.js
                </a>
              
                
                <a class="source" href="dom-014b.html">
                  ./demo/dom-014b.js
                </a>
              
                
                <a class="source" href="dom-014c.html">
                  ./demo/dom-014c.js
                </a>
              
                
                <a class="source" href="dom-015.html">
                  ./demo/dom-015.js
                </a>
              
                
                <a class="source" href="experiment-010.html">
                  ./demo/experiment-010.js
                </a>
              
            </div>
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <h1 id="demo-dom-001">Demo DOM 001</h1>
<p>Loading the scrawl-canvas library using a script tag in the HTML code</p>

            </div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p><a href="../../demo/dom-001.html">Run code</a></p>

            </div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <h4 id="imports">Imports</h4>
<p>Import Scrawl-canvas. It will auto-initialize the page as soon as it loads.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">import</span> scrawl <span class="hljs-keyword">from</span> <span class="hljs-string">'../source/scrawl.js'</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <h4 id="scene-setup">Scene setup</h4>
<p>Define some demo variables. All Scrawl-canvas wrappers for DOM elements can be found in the <strong>scrawl.library.artefact</strong> section of the Scrawl-canvas library. The elements themselves are held in the <strong>domElement</strong> attribute of the wrapper. </p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">let</span> artefact = scrawl.library.artefact,
    myStack = artefact.mystack,
    report = artefact.reportmessage;</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>Scrawl-canvas stack elements calculate the positions and dimensions of their member artefacts on the assumption that the stack element itself has no padding. If the element does include padding then all member artefacts will be offset (rightwards and downwards) by the left and top padfding values.</p>
<p>Stack element padding can be set to zero either using regular CSS, or programatically as shown below.</p>
<p>TODO: fix this - it’s very annoying!</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>myStack.set({
    <span class="hljs-attr">css</span>: {
        <span class="hljs-attr">padding</span>: <span class="hljs-number">0</span>
    }
});</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>Position and size the report &lt;div&gt; element, which is where we will be displaying details about the stack.</p>
<p>Note that moving this div element will leave a gap at the top of the stack. The positions and dimensions of Stack member artefacts (in other words, all immediate child elements of the stack element) are calculated when Scrawl-canvas initializes, before Scrawl-canvas updates their CSS position value to “absolute”. Thus moving the report div downwards will not trigger a DOM redraw/reflow action</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>report.set({
    <span class="hljs-attr">startY</span>: <span class="hljs-string">'50%'</span>,
    <span class="hljs-attr">width</span>: <span class="hljs-string">'91.5%'</span>,
    <span class="hljs-attr">height</span>: <span class="hljs-string">'auto'</span>
});</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <h4 id="scene-animation">Scene animation</h4>
<p>The animation loop updates the output with details of the stack’s dimensions and positioning, and details of the mouse cursor’s position in relation to the stack’s top-left hand corner.</p>
<p>Much of the data required for the information panel is contained in the stack wrapper’s <strong>here</strong> object. This data is updated every time Scrawl-canvas detects some sort of user interaction such as a mouse/pointer cursor movement, page scrolling, or when the browser window resizes.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>scrawl.makeAnimation({</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>Giving the animation object a name will make it easy to find in the Scrawl-canvas library object</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    name: <span class="hljs-string">'demo-animation'</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>Every animation object must include a <strong>fn</strong> function attribute which <strong><em>MUST</em></strong> return a Promise object - even if the functionality within the function is entirely synchronous. </p>
<p>This is because some animation functions (for instance: canvas filters) rely on web workers to speed up their calculations which are - by definition - asynchronous. The promise should resolve as true if all is well; false otherwise</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    fn: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {

            scrawl.render()
            .then(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {

                <span class="hljs-keyword">let</span> here = myStack.here || {};

                reportmessage.textContent =  <span class="hljs-string">`File dom-001.js has loaded successfully
   Stack name: <span class="hljs-subst">${myStack.name}</span> - width: <span class="hljs-subst">${here.w}</span>, height: <span class="hljs-subst">${here.h}</span>
   Interaction type: <span class="hljs-subst">${here.type}</span> - active: <span class="hljs-subst">${here.active}</span>
   Current cursor coordinates - x: <span class="hljs-subst">${here.x}</span>, y: <span class="hljs-subst">${here.y}</span> 
   Current stack normals values - x: <span class="hljs-subst">${here.normX.toFixed(<span class="hljs-number">4</span>)}</span>, y: <span class="hljs-subst">${here.normY.toFixed(<span class="hljs-number">4</span>)}</span>`</span>;

                resolve(<span class="hljs-literal">true</span>);
            })</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>Always (ALWAYS!) include a .catch function in the render promise chain (usually at the end)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            .catch(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> {

                reportmessage.textContent = err.message;
                resolve(<span class="hljs-literal">false</span>);
            });
        });
    }
});</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <h4 id="development-and-testing">Development and testing</h4>
<p>Because the code has been loaded as a <strong>module</strong>, Scrawl-canvas attributes and functions do not get added to the global namespace. For development work, we can overcome this issue (to a small extent) by console logging the scrawl library, so we can check internal attribute values and calculation results.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-built_in">console</span>.log(scrawl.library);</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>A more interactive method is to assign the scrawl object to a window global variable - this then allows us to access all of the objects created by Scrawl-canvas and interact with them in the browser console:</p>
<pre><code><span class="hljs-comment">// In the .js module file</span>
<span class="hljs-built_in">window</span>.scrawl = scrawl;

<span class="hljs-comment">// In the browser console</span>
<span class="hljs-keyword">let</span> b = scrawl.makeBlock({ ...etc... });
b.set({ ... etc ... });

<span class="hljs-keyword">let</span> a = scrawl.library.artefact[<span class="hljs-string">'my-artefact'</span>];
a.set({ ... etc ... })</code></pre>

            </div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
