<!DOCTYPE html>

<html>
<head>
  <title>utilities.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="../docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page_wrapper">
            <div id="jump_page">
              
                
                <a class="source" href="canvas-001.html">
                  ./demo/canvas-001.js
                </a>
              
                
                <a class="source" href="canvas-002.html">
                  ./demo/canvas-002.js
                </a>
              
                
                <a class="source" href="canvas-003.html">
                  ./demo/canvas-003.js
                </a>
              
                
                <a class="source" href="canvas-004.html">
                  ./demo/canvas-004.js
                </a>
              
                
                <a class="source" href="canvas-005.html">
                  ./demo/canvas-005.js
                </a>
              
                
                <a class="source" href="canvas-006.html">
                  ./demo/canvas-006.js
                </a>
              
                
                <a class="source" href="canvas-007.html">
                  ./demo/canvas-007.js
                </a>
              
                
                <a class="source" href="canvas-008.html">
                  ./demo/canvas-008.js
                </a>
              
                
                <a class="source" href="canvas-009.html">
                  ./demo/canvas-009.js
                </a>
              
                
                <a class="source" href="canvas-010.html">
                  ./demo/canvas-010.js
                </a>
              
                
                <a class="source" href="canvas-011.html">
                  ./demo/canvas-011.js
                </a>
              
                
                <a class="source" href="canvas-012.html">
                  ./demo/canvas-012.js
                </a>
              
                
                <a class="source" href="canvas-013.html">
                  ./demo/canvas-013.js
                </a>
              
                
                <a class="source" href="canvas-014.html">
                  ./demo/canvas-014.js
                </a>
              
                
                <a class="source" href="canvas-015.html">
                  ./demo/canvas-015.js
                </a>
              
                
                <a class="source" href="canvas-015a.html">
                  ./demo/canvas-015a.js
                </a>
              
                
                <a class="source" href="canvas-016.html">
                  ./demo/canvas-016.js
                </a>
              
                
                <a class="source" href="canvas-017.html">
                  ./demo/canvas-017.js
                </a>
              
                
                <a class="source" href="canvas-018.html">
                  ./demo/canvas-018.js
                </a>
              
                
                <a class="source" href="canvas-019.html">
                  ./demo/canvas-019.js
                </a>
              
                
                <a class="source" href="canvas-019a.html">
                  ./demo/canvas-019a.js
                </a>
              
                
                <a class="source" href="canvas-020.html">
                  ./demo/canvas-020.js
                </a>
              
                
                <a class="source" href="canvas-021.html">
                  ./demo/canvas-021.js
                </a>
              
                
                <a class="source" href="canvas-022.html">
                  ./demo/canvas-022.js
                </a>
              
                
                <a class="source" href="canvas-023.html">
                  ./demo/canvas-023.js
                </a>
              
                
                <a class="source" href="canvas-024.html">
                  ./demo/canvas-024.js
                </a>
              
                
                <a class="source" href="canvas-025.html">
                  ./demo/canvas-025.js
                </a>
              
                
                <a class="source" href="canvas-026.html">
                  ./demo/canvas-026.js
                </a>
              
                
                <a class="source" href="canvas-027.html">
                  ./demo/canvas-027.js
                </a>
              
                
                <a class="source" href="canvas-028.html">
                  ./demo/canvas-028.js
                </a>
              
                
                <a class="source" href="canvas-029.html">
                  ./demo/canvas-029.js
                </a>
              
                
                <a class="source" href="canvas-030.html">
                  ./demo/canvas-030.js
                </a>
              
                
                <a class="source" href="canvas-031.html">
                  ./demo/canvas-031.js
                </a>
              
                
                <a class="source" href="canvas-032.html">
                  ./demo/canvas-032.js
                </a>
              
                
                <a class="source" href="canvas-033.html">
                  ./demo/canvas-033.js
                </a>
              
                
                <a class="source" href="canvas-034.html">
                  ./demo/canvas-034.js
                </a>
              
                
                <a class="source" href="canvas-035.html">
                  ./demo/canvas-035.js
                </a>
              
                
                <a class="source" href="canvas-036.html">
                  ./demo/canvas-036.js
                </a>
              
                
                <a class="source" href="canvas-037.html">
                  ./demo/canvas-037.js
                </a>
              
                
                <a class="source" href="canvas-038.html">
                  ./demo/canvas-038.js
                </a>
              
                
                <a class="source" href="canvas-039.html">
                  ./demo/canvas-039.js
                </a>
              
                
                <a class="source" href="canvas-040.html">
                  ./demo/canvas-040.js
                </a>
              
                
                <a class="source" href="canvas-041.html">
                  ./demo/canvas-041.js
                </a>
              
                
                <a class="source" href="canvas-042.html">
                  ./demo/canvas-042.js
                </a>
              
                
                <a class="source" href="canvas-043.html">
                  ./demo/canvas-043.js
                </a>
              
                
                <a class="source" href="canvas-044.html">
                  ./demo/canvas-044.js
                </a>
              
                
                <a class="source" href="canvas-045.html">
                  ./demo/canvas-045.js
                </a>
              
                
                <a class="source" href="canvas-046.html">
                  ./demo/canvas-046.js
                </a>
              
                
                <a class="source" href="canvas-047.html">
                  ./demo/canvas-047.js
                </a>
              
                
                <a class="source" href="canvas-048.html">
                  ./demo/canvas-048.js
                </a>
              
                
                <a class="source" href="canvas-049.html">
                  ./demo/canvas-049.js
                </a>
              
                
                <a class="source" href="canvas-050.html">
                  ./demo/canvas-050.js
                </a>
              
                
                <a class="source" href="canvas-051.html">
                  ./demo/canvas-051.js
                </a>
              
                
                <a class="source" href="canvas-052.html">
                  ./demo/canvas-052.js
                </a>
              
                
                <a class="source" href="canvas-053.html">
                  ./demo/canvas-053.js
                </a>
              
                
                <a class="source" href="canvas-054.html">
                  ./demo/canvas-054.js
                </a>
              
                
                <a class="source" href="canvas-055.html">
                  ./demo/canvas-055.js
                </a>
              
                
                <a class="source" href="canvas-056.html">
                  ./demo/canvas-056.js
                </a>
              
                
                <a class="source" href="canvas-057.html">
                  ./demo/canvas-057.js
                </a>
              
                
                <a class="source" href="canvas-058.html">
                  ./demo/canvas-058.js
                </a>
              
                
                <a class="source" href="canvas-059.html">
                  ./demo/canvas-059.js
                </a>
              
                
                <a class="source" href="canvas-060.html">
                  ./demo/canvas-060.js
                </a>
              
                
                <a class="source" href="canvas-061.html">
                  ./demo/canvas-061.js
                </a>
              
                
                <a class="source" href="canvas-062.html">
                  ./demo/canvas-062.js
                </a>
              
                
                <a class="source" href="canvas-063.html">
                  ./demo/canvas-063.js
                </a>
              
                
                <a class="source" href="canvas-064.html">
                  ./demo/canvas-064.js
                </a>
              
                
                <a class="source" href="canvas-065.html">
                  ./demo/canvas-065.js
                </a>
              
                
                <a class="source" href="delaunator-001.html">
                  ./demo/delaunator-001.js
                </a>
              
                
                <a class="source" href="delaunator-002.html">
                  ./demo/delaunator-002.js
                </a>
              
                
                <a class="source" href="dom-001.html">
                  ./demo/dom-001.js
                </a>
              
                
                <a class="source" href="dom-002.html">
                  ./demo/dom-002.js
                </a>
              
                
                <a class="source" href="dom-003.html">
                  ./demo/dom-003.js
                </a>
              
                
                <a class="source" href="dom-004.html">
                  ./demo/dom-004.js
                </a>
              
                
                <a class="source" href="dom-005.html">
                  ./demo/dom-005.js
                </a>
              
                
                <a class="source" href="dom-006.html">
                  ./demo/dom-006.js
                </a>
              
                
                <a class="source" href="dom-007.html">
                  ./demo/dom-007.js
                </a>
              
                
                <a class="source" href="dom-008.html">
                  ./demo/dom-008.js
                </a>
              
                
                <a class="source" href="dom-009.html">
                  ./demo/dom-009.js
                </a>
              
                
                <a class="source" href="dom-010.html">
                  ./demo/dom-010.js
                </a>
              
                
                <a class="source" href="dom-011.html">
                  ./demo/dom-011.js
                </a>
              
                
                <a class="source" href="dom-012.html">
                  ./demo/dom-012.js
                </a>
              
                
                <a class="source" href="dom-013.html">
                  ./demo/dom-013.js
                </a>
              
                
                <a class="source" href="dom-015.html">
                  ./demo/dom-015.js
                </a>
              
                
                <a class="source" href="dom-016.html">
                  ./demo/dom-016.js
                </a>
              
                
                <a class="source" href="dom-017.html">
                  ./demo/dom-017.js
                </a>
              
                
                <a class="source" href="dom-018.html">
                  ./demo/dom-018.js
                </a>
              
                
                <a class="source" href="dom-019.html">
                  ./demo/dom-019.js
                </a>
              
                
                <a class="source" href="dom-020.html">
                  ./demo/dom-020.js
                </a>
              
                
                <a class="source" href="dom-021.html">
                  ./demo/dom-021.js
                </a>
              
                
                <a class="source" href="filters-001.html">
                  ./demo/filters-001.js
                </a>
              
                
                <a class="source" href="filters-002.html">
                  ./demo/filters-002.js
                </a>
              
                
                <a class="source" href="filters-002a.html">
                  ./demo/filters-002a.js
                </a>
              
                
                <a class="source" href="filters-003.html">
                  ./demo/filters-003.js
                </a>
              
                
                <a class="source" href="filters-004.html">
                  ./demo/filters-004.js
                </a>
              
                
                <a class="source" href="filters-005.html">
                  ./demo/filters-005.js
                </a>
              
                
                <a class="source" href="filters-006.html">
                  ./demo/filters-006.js
                </a>
              
                
                <a class="source" href="filters-007.html">
                  ./demo/filters-007.js
                </a>
              
                
                <a class="source" href="filters-008.html">
                  ./demo/filters-008.js
                </a>
              
                
                <a class="source" href="filters-009.html">
                  ./demo/filters-009.js
                </a>
              
                
                <a class="source" href="filters-010.html">
                  ./demo/filters-010.js
                </a>
              
                
                <a class="source" href="filters-011.html">
                  ./demo/filters-011.js
                </a>
              
                
                <a class="source" href="filters-012.html">
                  ./demo/filters-012.js
                </a>
              
                
                <a class="source" href="filters-013.html">
                  ./demo/filters-013.js
                </a>
              
                
                <a class="source" href="filters-014.html">
                  ./demo/filters-014.js
                </a>
              
                
                <a class="source" href="filters-015.html">
                  ./demo/filters-015.js
                </a>
              
                
                <a class="source" href="filters-016.html">
                  ./demo/filters-016.js
                </a>
              
                
                <a class="source" href="filters-017.html">
                  ./demo/filters-017.js
                </a>
              
                
                <a class="source" href="filters-018.html">
                  ./demo/filters-018.js
                </a>
              
                
                <a class="source" href="filters-019.html">
                  ./demo/filters-019.js
                </a>
              
                
                <a class="source" href="filters-020.html">
                  ./demo/filters-020.js
                </a>
              
                
                <a class="source" href="filters-021.html">
                  ./demo/filters-021.js
                </a>
              
                
                <a class="source" href="filters-022.html">
                  ./demo/filters-022.js
                </a>
              
                
                <a class="source" href="filters-023.html">
                  ./demo/filters-023.js
                </a>
              
                
                <a class="source" href="filters-024.html">
                  ./demo/filters-024.js
                </a>
              
                
                <a class="source" href="filters-025.html">
                  ./demo/filters-025.js
                </a>
              
                
                <a class="source" href="filters-026.html">
                  ./demo/filters-026.js
                </a>
              
                
                <a class="source" href="filters-027.html">
                  ./demo/filters-027.js
                </a>
              
                
                <a class="source" href="filters-028.html">
                  ./demo/filters-028.js
                </a>
              
                
                <a class="source" href="filters-101.html">
                  ./demo/filters-101.js
                </a>
              
                
                <a class="source" href="filters-102.html">
                  ./demo/filters-102.js
                </a>
              
                
                <a class="source" href="filters-103.html">
                  ./demo/filters-103.js
                </a>
              
                
                <a class="source" href="filters-104.html">
                  ./demo/filters-104.js
                </a>
              
                
                <a class="source" href="filters-105.html">
                  ./demo/filters-105.js
                </a>
              
                
                <a class="source" href="filters-501.html">
                  ./demo/filters-501.js
                </a>
              
                
                <a class="source" href="filters-502.html">
                  ./demo/filters-502.js
                </a>
              
                
                <a class="source" href="filters-503.html">
                  ./demo/filters-503.js
                </a>
              
                
                <a class="source" href="filters-504.html">
                  ./demo/filters-504.js
                </a>
              
                
                <a class="source" href="filters-505.html">
                  ./demo/filters-505.js
                </a>
              
                
                <a class="source" href="mediapipe-001.html">
                  ./demo/mediapipe-001.js
                </a>
              
                
                <a class="source" href="mediapipe-002.html">
                  ./demo/mediapipe-002.js
                </a>
              
                
                <a class="source" href="mediapipe-003.html">
                  ./demo/mediapipe-003.js
                </a>
              
                
                <a class="source" href="modules-001.html">
                  ./demo/modules-001.js
                </a>
              
                
                <a class="source" href="modules-002.html">
                  ./demo/modules-002.js
                </a>
              
                
                <a class="source" href="modules-003.html">
                  ./demo/modules-003.js
                </a>
              
                
                <a class="source" href="modules-004.html">
                  ./demo/modules-004.js
                </a>
              
                
                <a class="source" href="modules-005.html">
                  ./demo/modules-005.js
                </a>
              
                
                <a class="source" href="modules-006.html">
                  ./demo/modules-006.js
                </a>
              
                
                <a class="source" href="packets-001.html">
                  ./demo/packets-001.js
                </a>
              
                
                <a class="source" href="packets-002.html">
                  ./demo/packets-002.js
                </a>
              
                
                <a class="source" href="particles-001.html">
                  ./demo/particles-001.js
                </a>
              
                
                <a class="source" href="particles-002.html">
                  ./demo/particles-002.js
                </a>
              
                
                <a class="source" href="particles-003.html">
                  ./demo/particles-003.js
                </a>
              
                
                <a class="source" href="particles-004.html">
                  ./demo/particles-004.js
                </a>
              
                
                <a class="source" href="particles-005.html">
                  ./demo/particles-005.js
                </a>
              
                
                <a class="source" href="particles-006.html">
                  ./demo/particles-006.js
                </a>
              
                
                <a class="source" href="particles-007.html">
                  ./demo/particles-007.js
                </a>
              
                
                <a class="source" href="particles-008.html">
                  ./demo/particles-008.js
                </a>
              
                
                <a class="source" href="particles-009.html">
                  ./demo/particles-009.js
                </a>
              
                
                <a class="source" href="particles-010.html">
                  ./demo/particles-010.js
                </a>
              
                
                <a class="source" href="particles-011.html">
                  ./demo/particles-011.js
                </a>
              
                
                <a class="source" href="particles-012.html">
                  ./demo/particles-012.js
                </a>
              
                
                <a class="source" href="particles-013.html">
                  ./demo/particles-013.js
                </a>
              
                
                <a class="source" href="particles-014.html">
                  ./demo/particles-014.js
                </a>
              
                
                <a class="source" href="particles-015.html">
                  ./demo/particles-015.js
                </a>
              
                
                <a class="source" href="particles-016.html">
                  ./demo/particles-016.js
                </a>
              
                
                <a class="source" href="rapier-001.html">
                  ./demo/rapier-001.js
                </a>
              
                
                <a class="source" href="snippets-001.html">
                  ./demo/snippets-001.js
                </a>
              
                
                <a class="source" href="snippets-002.html">
                  ./demo/snippets-002.js
                </a>
              
                
                <a class="source" href="snippets-003.html">
                  ./demo/snippets-003.js
                </a>
              
                
                <a class="source" href="snippets-004.html">
                  ./demo/snippets-004.js
                </a>
              
                
                <a class="source" href="snippets-005.html">
                  ./demo/snippets-005.js
                </a>
              
                
                <a class="source" href="snippets-006.html">
                  ./demo/snippets-006.js
                </a>
              
                
                <a class="source" href="tensorflow-001.html">
                  ./demo/tensorflow-001.js
                </a>
              
                
                <a class="source" href="tensorflow-002.html">
                  ./demo/tensorflow-002.js
                </a>
              
                
                <a class="source" href="utilities.html">
                  ./demo/utilities.js
                </a>
              
            </div>
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>utilities.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-1">&#x00a7;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> scrawl <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../source/scrawl.js&#x27;</span>;
<span class="hljs-keyword">const</span> L = scrawl.<span class="hljs-property">library</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-2">&#x00a7;</a>
              </div>
              <p>Function to display frames-per-second data, and other information relevant to the demo</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">const</span> reportSpeed = <span class="hljs-keyword">function</span> (<span class="hljs-params">output = <span class="hljs-string">&#x27;&#x27;</span>, xtra = () =&gt; <span class="hljs-string">&#x27;&#x27;</span></span>) {

    <span class="hljs-keyword">if</span> (!output) <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {};

        <span class="hljs-keyword">const</span> testMessage = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(output),
            history = []

        <span class="hljs-keyword">let</span> testTicker = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(),
            testTime, testNow,
            averageTime = <span class="hljs-number">0</span>;

        <span class="hljs-keyword">const</span> <span class="hljs-title function_">addTime</span> = (<span class="hljs-params">t</span>) =&gt; {

            <span class="hljs-keyword">if</span> (history.<span class="hljs-property">length</span> &gt; <span class="hljs-number">60</span>) history.<span class="hljs-title function_">shift</span>();
            history.<span class="hljs-title function_">push</span>(t);
            averageTime = history.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">p, c</span>) =&gt;</span> p + c, <span class="hljs-number">0</span>);
            averageTime /= history.<span class="hljs-property">length</span>;
        }


    <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {

        testNow = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();

        testTime = testNow - testTicker;
        testTicker = testNow;

        <span class="hljs-title function_">addTime</span>(testTime);

        <span class="hljs-keyword">let</span> text = <span class="hljs-string">`Screen refresh: <span class="hljs-subst">${<span class="hljs-built_in">Math</span>.ceil(averageTime)}</span>ms; fps: <span class="hljs-subst">${<span class="hljs-built_in">Math</span>.floor(<span class="hljs-number">1000</span> / averageTime)}</span>`</span>;

        <span class="hljs-keyword">if</span> (xtra) {

            text += <span class="hljs-string">`
<span class="hljs-subst">${xtra()}</span>`</span>;
        }

        testMessage.<span class="hljs-property">textContent</span> = text;
    };
};</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-3">&#x00a7;</a>
              </div>
              <p>Get a full, dynamic report on the Scrawl-canvas library’s current contents</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">const</span> <span class="hljs-title function_">reportFullLibrary</span> = (<span class="hljs-params">scrawl</span>) =&gt; {

    <span class="hljs-keyword">const</span> {
        anchor, anchornames,
        animation, animationnames,
        animationtickers, animationtickersnames,
        artefact, artefactnames,
        asset, assetnames,
        canvas, canvasnames,
        cell, cellnames,
        element, elementnames,
        entity, entitynames,
        filter, filternames,
        force, forcenames,
        group, groupnames,
        particle, particlenames,
        spring, springnames,
        stack, stacknames,
        styles, stylesnames,
        tween, tweennames,
        unstackedelement, unstackedelementnames,
        world, worldnames,
    } = scrawl.<span class="hljs-property">library</span>;

    <span class="hljs-keyword">const</span> <span class="hljs-title function_">compareObjectToArray</span> = (<span class="hljs-params">obj, arr</span>) =&gt; {

        <span class="hljs-keyword">const</span> keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(obj);

        <span class="hljs-keyword">if</span> (keys.<span class="hljs-property">length</span> !== arr.<span class="hljs-property">length</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;

        <span class="hljs-keyword">return</span> keys.<span class="hljs-title function_">every</span>(<span class="hljs-function"><span class="hljs-params">k</span> =&gt;</span> arr.<span class="hljs-title function_">includes</span>(k));
    };

    <span class="hljs-keyword">const</span> <span class="hljs-title function_">getSectionOutput</span> = (<span class="hljs-params">label, obj, arr</span>) =&gt; {

        <span class="hljs-keyword">if</span> (<span class="hljs-string">&#x27;animation&#x27;</span> === label) {
            <span class="hljs-keyword">let</span> t = <span class="hljs-string">`<span class="hljs-subst">${label}</span>: <span class="hljs-subst">${arr.length}</span> (<span class="hljs-subst">${compareObjectToArray(obj, arr)}</span>)`</span>;
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [key, value] <span class="hljs-keyword">of</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(obj)) {
                t += <span class="hljs-string">`\n    <span class="hljs-subst">${key}</span> - <span class="hljs-subst">${value.isRunning() ? <span class="hljs-string">&#x27;running&#x27;</span> : <span class="hljs-string">&#x27;halted&#x27;</span>}</span>`</span>;
            }
            <span class="hljs-keyword">return</span> t;
        }

        <span class="hljs-keyword">if</span> (<span class="hljs-string">&#x27;animationtickers&#x27;</span> === label) {
            <span class="hljs-keyword">let</span> t = <span class="hljs-string">`<span class="hljs-subst">${label}</span>: <span class="hljs-subst">${arr.length}</span> (<span class="hljs-subst">${compareObjectToArray(obj, arr)}</span>)`</span>;
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [key, value] <span class="hljs-keyword">of</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(obj)) {
                t += <span class="hljs-string">`\n    <span class="hljs-subst">${key}</span> - <span class="hljs-subst">${value.isRunning() &amp;&amp; value.checkObserverRunningState() ? <span class="hljs-string">&#x27;running&#x27;</span> : <span class="hljs-string">&#x27;halted&#x27;</span>}</span>`</span>;
            }
            <span class="hljs-keyword">return</span> t;
        }

        <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${label}</span>: <span class="hljs-subst">${arr.length}</span> (<span class="hljs-subst">${compareObjectToArray(obj, arr)}</span>) - <span class="hljs-subst">${arr.join(<span class="hljs-string">&#x27;, &#x27;</span>)}</span>`</span>;
    };
    <span class="hljs-keyword">return</span> <span class="hljs-string">`
<span class="hljs-subst">${getSectionOutput(<span class="hljs-string">&#x27;anchor&#x27;</span>, anchor, anchornames)}</span>
<span class="hljs-subst">${getSectionOutput(<span class="hljs-string">&#x27;animation&#x27;</span>, animation, animationnames)}</span>
<span class="hljs-subst">${getSectionOutput(<span class="hljs-string">&#x27;animationtickers&#x27;</span>, animationtickers, animationtickersnames)}</span>
<span class="hljs-subst">${getSectionOutput(<span class="hljs-string">&#x27;artefact&#x27;</span>, artefact, artefactnames)}</span>
<span class="hljs-subst">${getSectionOutput(<span class="hljs-string">&#x27;asset&#x27;</span>, asset, assetnames)}</span>
<span class="hljs-subst">${getSectionOutput(<span class="hljs-string">&#x27;canvas&#x27;</span>, canvas, canvasnames)}</span>
<span class="hljs-subst">${getSectionOutput(<span class="hljs-string">&#x27;cell&#x27;</span>, cell, cellnames)}</span>
<span class="hljs-subst">${getSectionOutput(<span class="hljs-string">&#x27;element&#x27;</span>, element, elementnames)}</span>
<span class="hljs-subst">${getSectionOutput(<span class="hljs-string">&#x27;entity&#x27;</span>, entity, entitynames)}</span>
<span class="hljs-subst">${getSectionOutput(<span class="hljs-string">&#x27;filter&#x27;</span>, filter, filternames)}</span>
<span class="hljs-subst">${getSectionOutput(<span class="hljs-string">&#x27;force&#x27;</span>, force, forcenames)}</span>
<span class="hljs-subst">${getSectionOutput(<span class="hljs-string">&#x27;group&#x27;</span>, group, groupnames)}</span>
<span class="hljs-subst">${getSectionOutput(<span class="hljs-string">&#x27;particle&#x27;</span>, particle, particlenames)}</span>
<span class="hljs-subst">${getSectionOutput(<span class="hljs-string">&#x27;spring&#x27;</span>, spring, springnames)}</span>
<span class="hljs-subst">${getSectionOutput(<span class="hljs-string">&#x27;stack&#x27;</span>, stack, stacknames)}</span>
<span class="hljs-subst">${getSectionOutput(<span class="hljs-string">&#x27;styles&#x27;</span>, styles, stylesnames)}</span>
<span class="hljs-subst">${getSectionOutput(<span class="hljs-string">&#x27;tween&#x27;</span>, tween, tweennames)}</span>
<span class="hljs-subst">${getSectionOutput(<span class="hljs-string">&#x27;unstackedelement&#x27;</span>, unstackedelement, unstackedelementnames)}</span>
<span class="hljs-subst">${getSectionOutput(<span class="hljs-string">&#x27;world&#x27;</span>, world, worldnames)}</span>
    `</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-4">&#x00a7;</a>
              </div>
              <p>Test to check that artefacts are properly killed and resurrected</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">const</span> <span class="hljs-title function_">killArtefact</span> = (<span class="hljs-params">canvas, name, time, finishResurrection = () =&gt; {}</span>) =&gt; {

    <span class="hljs-keyword">if</span> (canvas &amp;&amp; canvas.<span class="hljs-property">base</span> &amp;&amp; name &amp;&amp; time) {

        <span class="hljs-keyword">const</span> groupname = canvas.<span class="hljs-property">base</span>.<span class="hljs-property">name</span>;

        <span class="hljs-keyword">let</span> res, packet;

        <span class="hljs-keyword">const</span> <span class="hljs-title function_">checkGroupBucket</span> = (<span class="hljs-params">name, groupname</span>) =&gt; {

            res = L.<span class="hljs-property">group</span>[groupname].<span class="hljs-property">artefactCalculateBuckets</span>.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> e.<span class="hljs-property">name</span> === name );
            <span class="hljs-keyword">return</span> (res.<span class="hljs-property">length</span>) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>;
        };

        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {

            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${name}</span> alive
        removed from artefact: <span class="hljs-subst">${(L.artefact[name]) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>
        removed from artefactnames: <span class="hljs-subst">${(L.artefactnames.indexOf(name) &gt;= <span class="hljs-number">0</span>) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>
        removed from entity: <span class="hljs-subst">${(L.entity[name]) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>
        removed from entitynames: <span class="hljs-subst">${(L.entitynames.indexOf(name) &gt;= <span class="hljs-number">0</span>) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>
        removed from group.artefacts: <span class="hljs-subst">${(L.group[groupname].artefacts.indexOf(name) &gt;= <span class="hljs-number">0</span>) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>
        removed from group.artefactCalculateBuckets: <span class="hljs-subst">${checkGroupBucket(name, groupname)}</span>`</span>);

            packet = L.<span class="hljs-property">artefact</span>[name].<span class="hljs-title function_">saveAsPacket</span>();

            L.<span class="hljs-property">artefact</span>[name].<span class="hljs-title function_">kill</span>();

            <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {

                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${name}</span> killed
        removed from artefact: <span class="hljs-subst">${(L.artefact[name]) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>
        removed from artefactnames: <span class="hljs-subst">${(L.artefactnames.indexOf(name) &gt;= <span class="hljs-number">0</span>) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>
        removed from entity: <span class="hljs-subst">${(L.entity[name]) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>
        removed from entitynames: <span class="hljs-subst">${(L.entitynames.indexOf(name) &gt;= <span class="hljs-number">0</span>) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>
        removed from group.artefacts: <span class="hljs-subst">${(L.group[groupname].artefacts.indexOf(name) &gt;= <span class="hljs-number">0</span>) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>
        removed from group.artefactCalculateBuckets: <span class="hljs-subst">${checkGroupBucket(name, groupname)}</span>`</span>);

                canvas.<span class="hljs-title function_">actionPacket</span>(packet);

                <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {

                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${name}</span> resurrected
        removed from artefact: <span class="hljs-subst">${(L.artefact[name]) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>
        removed from artefactnames: <span class="hljs-subst">${(L.artefactnames.indexOf(name) &gt;= <span class="hljs-number">0</span>) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>
        removed from entity: <span class="hljs-subst">${(L.entity[name]) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>
        removed from entitynames: <span class="hljs-subst">${(L.entitynames.indexOf(name) &gt;= <span class="hljs-number">0</span>) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>
        removed from group.artefacts: <span class="hljs-subst">${(L.group[groupname].artefacts.indexOf(name) &gt;= <span class="hljs-number">0</span>) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>
        removed from group.artefactCalculateBuckets: <span class="hljs-subst">${checkGroupBucket(name, groupname)}</span>`</span>);

                    <span class="hljs-keyword">if</span> (finishResurrection) <span class="hljs-title function_">finishResurrection</span>();

                }, <span class="hljs-number">100</span>);
            }, <span class="hljs-number">100</span>);
        }, time);
    }
    <span class="hljs-keyword">else</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;killArtefact test invoked improperly&#x27;</span>);
};</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-5">&#x00a7;</a>
              </div>
              <p>To test styles (Gradient) kill functionality</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">const</span> <span class="hljs-title function_">killStyle</span> = (<span class="hljs-params">canvas, name, time, finishResurrection = () =&gt; {}</span>) =&gt; {

    <span class="hljs-keyword">if</span> (canvas &amp;&amp; canvas.<span class="hljs-property">base</span> &amp;&amp; name &amp;&amp; time) {

        <span class="hljs-keyword">let</span> packet;

        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {

            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${name}</span> alive
        removed from styles: <span class="hljs-subst">${(L.styles[name]) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>
        removed from stylesnames: <span class="hljs-subst">${(L.stylesnames.indexOf(name) &gt;= <span class="hljs-number">0</span>) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>`</span>);

            packet = L.<span class="hljs-property">styles</span>[name].<span class="hljs-title function_">saveAsPacket</span>();

            L.<span class="hljs-property">styles</span>[name].<span class="hljs-title function_">kill</span>();

            <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {

                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${name}</span> killed
        removed from styles: <span class="hljs-subst">${(L.styles[name]) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>
        removed from stylesnames: <span class="hljs-subst">${(L.stylesnames.indexOf(name) &gt;= <span class="hljs-number">0</span>) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>`</span>);

                canvas.<span class="hljs-title function_">actionPacket</span>(packet);

                <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {

                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${name}</span> resurrected
        removed from styles: <span class="hljs-subst">${(L.styles[name]) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>
        removed from stylesnames: <span class="hljs-subst">${(L.stylesnames.indexOf(name) &gt;= <span class="hljs-number">0</span>) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>`</span>);

                    <span class="hljs-title function_">finishResurrection</span>();

                }, <span class="hljs-number">100</span>);
            }, <span class="hljs-number">100</span>);
        }, time);
    }
    <span class="hljs-keyword">else</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;killStyle test invoked improperly&#x27;</span>);
};</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-6">&#x00a7;</a>
              </div>
              <p>To test artefact + anchor kill functionality</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">const</span> <span class="hljs-title function_">killArtefactAndAnchor</span> = (<span class="hljs-params">canvas, name, anchorname, time, finishResurrection = () =&gt; {}</span>) =&gt; {

    <span class="hljs-keyword">const</span> groupname = <span class="hljs-string">&#x27;mycanvas_base&#x27;</span>;

    <span class="hljs-keyword">let</span> packet, res;

    <span class="hljs-keyword">const</span> <span class="hljs-title function_">checkGroupBucket</span> = (<span class="hljs-params">name, groupname</span>) =&gt; {

        res = L.<span class="hljs-property">group</span>[groupname].<span class="hljs-property">artefactCalculateBuckets</span>.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> e.<span class="hljs-property">name</span> === name );
        <span class="hljs-keyword">return</span> (res.<span class="hljs-property">length</span>) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>;
    };

    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {

        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${name}</span> alive
    removed from artefact: <span class="hljs-subst">${(L.artefact[name]) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>
    removed from artefactnames: <span class="hljs-subst">${(L.artefactnames.indexOf(name) &gt;= <span class="hljs-number">0</span>) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>
    removed from entity: <span class="hljs-subst">${(L.entity[name]) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>
    removed from entitynames: <span class="hljs-subst">${(L.entitynames.indexOf(name) &gt;= <span class="hljs-number">0</span>) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>
    removed from group.artefacts: <span class="hljs-subst">${(L.group[groupname].artefacts.indexOf(name) &gt;= <span class="hljs-number">0</span>) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>
    removed from group.artefactCalculateBuckets: <span class="hljs-subst">${checkGroupBucket(name, groupname)}</span>
    anchor removed: <span class="hljs-subst">${(L.anchor[anchorname]) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>`</span>);

        packet = L.<span class="hljs-property">artefact</span>[name].<span class="hljs-title function_">saveAsPacket</span>();

        L.<span class="hljs-property">artefact</span>[name].<span class="hljs-title function_">kill</span>();

        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {

            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${name}</span> killed
    removed from artefact: <span class="hljs-subst">${(L.artefact[name]) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>
    removed from artefactnames: <span class="hljs-subst">${(L.artefactnames.indexOf(name) &gt;= <span class="hljs-number">0</span>) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>
    removed from entity: <span class="hljs-subst">${(L.entity[name]) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>
    removed from entitynames: <span class="hljs-subst">${(L.entitynames.indexOf(name) &gt;= <span class="hljs-number">0</span>) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>
    removed from group.artefacts: <span class="hljs-subst">${(L.group[groupname].artefacts.indexOf(name) &gt;= <span class="hljs-number">0</span>) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>
    removed from group.artefactCalculateBuckets: <span class="hljs-subst">${checkGroupBucket(name, groupname)}</span>
    anchor removed: <span class="hljs-subst">${(L.anchor[anchorname]) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>`</span>);

            canvas.<span class="hljs-title function_">actionPacket</span>(packet);

            <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {

                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${name}</span> resurrected
    removed from artefact: <span class="hljs-subst">${(L.artefact[name]) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>
    removed from artefactnames: <span class="hljs-subst">${(L.artefactnames.indexOf(name) &gt;= <span class="hljs-number">0</span>) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>
    removed from entity: <span class="hljs-subst">${(L.entity[name]) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>
    removed from entitynames: <span class="hljs-subst">${(L.entitynames.indexOf(name) &gt;= <span class="hljs-number">0</span>) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>
    removed from group.artefacts: <span class="hljs-subst">${(L.group[groupname].artefacts.indexOf(name) &gt;= <span class="hljs-number">0</span>) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>
    removed from group.artefactCalculateBuckets: <span class="hljs-subst">${checkGroupBucket(name, groupname)}</span>
    anchor removed: <span class="hljs-subst">${(L.anchor[anchorname]) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>`</span>);

                <span class="hljs-title function_">finishResurrection</span>();

            }, <span class="hljs-number">100</span>);
        }, <span class="hljs-number">100</span>);
    }, time);
};</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-7">&#x00a7;</a>
              </div>
              <p>To test Polyline artefact kill functionality</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">const</span> <span class="hljs-title function_">killPolylineArtefact</span> = (<span class="hljs-params">canvas, name, time, myline, restore = () =&gt; {}</span>) =&gt; {

    <span class="hljs-keyword">const</span> groupname = <span class="hljs-string">&#x27;mycanvas_base&#x27;</span>;

    <span class="hljs-keyword">let</span> packet, res;

    <span class="hljs-keyword">const</span> <span class="hljs-title function_">checkGroupBucket</span> = (<span class="hljs-params">name, groupname</span>) =&gt; {

        res = L.<span class="hljs-property">group</span>[groupname].<span class="hljs-property">artefactCalculateBuckets</span>.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> e.<span class="hljs-property">name</span> === name );
        <span class="hljs-keyword">return</span> (res.<span class="hljs-property">length</span>) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>;
    };

    <span class="hljs-keyword">const</span> <span class="hljs-title function_">checkPinsArray</span> = (<span class="hljs-params">name</span>) =&gt; {

        <span class="hljs-keyword">if</span> (myline.<span class="hljs-property">pins</span>.<span class="hljs-title function_">indexOf</span>(name) &gt;= <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;no&#x27;</span>;

        res = myline.<span class="hljs-property">pins</span>.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> e &amp;&amp; e.<span class="hljs-property">name</span> === name );
        <span class="hljs-keyword">return</span> (res.<span class="hljs-property">length</span>) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>;
    };

    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {

        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${name}</span> alive
    removed from artefact: <span class="hljs-subst">${(L.artefact[name]) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>
    removed from artefactnames: <span class="hljs-subst">${(L.artefactnames.indexOf(name) &gt;= <span class="hljs-number">0</span>) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>
    removed from entity: <span class="hljs-subst">${(L.entity[name]) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>
    removed from entitynames: <span class="hljs-subst">${(L.entitynames.indexOf(name) &gt;= <span class="hljs-number">0</span>) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>
    removed from polyline pins array: <span class="hljs-subst">${checkPinsArray(name)}</span>
    removed from group.artefacts: <span class="hljs-subst">${(L.group[groupname].artefacts.indexOf(name) &gt;= <span class="hljs-number">0</span>) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>
    removed from group.artefactCalculateBuckets: <span class="hljs-subst">${checkGroupBucket(name, groupname)}</span>`</span>);

        packet = L.<span class="hljs-property">artefact</span>[name].<span class="hljs-title function_">saveAsPacket</span>();

        L.<span class="hljs-property">artefact</span>[name].<span class="hljs-title function_">kill</span>();

        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {

            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${name}</span> killed
    removed from artefact: <span class="hljs-subst">${(L.artefact[name]) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>
    removed from artefactnames: <span class="hljs-subst">${(L.artefactnames.indexOf(name) &gt;= <span class="hljs-number">0</span>) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>
    removed from entity: <span class="hljs-subst">${(L.entity[name]) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>
    removed from entitynames: <span class="hljs-subst">${(L.entitynames.indexOf(name) &gt;= <span class="hljs-number">0</span>) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>
    removed from polyline pins array: <span class="hljs-subst">${checkPinsArray(name)}</span>
    removed from group.artefacts: <span class="hljs-subst">${(L.group[groupname].artefacts.indexOf(name) &gt;= <span class="hljs-number">0</span>) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>
    removed from group.artefactCalculateBuckets: <span class="hljs-subst">${checkGroupBucket(name, groupname)}</span>`</span>);

            canvas.<span class="hljs-title function_">actionPacket</span>(packet);

            <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {

                <span class="hljs-keyword">if</span> (restore) <span class="hljs-title function_">restore</span>();

                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${name}</span> resurrected
    removed from artefact: <span class="hljs-subst">${(L.artefact[name]) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>
    removed from artefactnames: <span class="hljs-subst">${(L.artefactnames.indexOf(name) &gt;= <span class="hljs-number">0</span>) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>
    removed from entity: <span class="hljs-subst">${(L.entity[name]) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>
    removed from entitynames: <span class="hljs-subst">${(L.entitynames.indexOf(name) &gt;= <span class="hljs-number">0</span>) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>
    removed from polyline pins array: <span class="hljs-subst">${checkPinsArray(name)}</span>
    removed from group.artefacts: <span class="hljs-subst">${(L.group[groupname].artefacts.indexOf(name) &gt;= <span class="hljs-number">0</span>) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>
    removed from group.artefactCalculateBuckets: <span class="hljs-subst">${checkGroupBucket(name, groupname)}</span>`</span>);

                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(myline.<span class="hljs-title function_">saveAsPacket</span>());

            }, <span class="hljs-number">500</span>);
        }, <span class="hljs-number">500</span>);
    }, time);
};

<span class="hljs-keyword">const</span> <span class="hljs-title function_">killTicker</span> = (<span class="hljs-params">stack, name, time</span>) =&gt; {

    <span class="hljs-keyword">let</span> packet;

    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {

        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${name}</span> alive
    removed from tickers: <span class="hljs-subst">${(L.animationtickers[name]) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>`</span>);

        packet = L.<span class="hljs-property">animationtickers</span>[name].<span class="hljs-title function_">saveAsPacket</span>();

        L.<span class="hljs-property">animationtickers</span>[name].<span class="hljs-title function_">kill</span>();

        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {

            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${name}</span> killed
    removed from tickers: <span class="hljs-subst">${(L.animationtickers[name]) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>`</span>);

            stack.<span class="hljs-title function_">actionPacket</span>(packet);

            <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {

                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${name}</span> resurrected
    removed from tickers: <span class="hljs-subst">${(L.animationtickers[name]) ? <span class="hljs-string">&#x27;no&#x27;</span> : <span class="hljs-string">&#x27;yes&#x27;</span>}</span>`</span>);
            }, <span class="hljs-number">100</span>);
        }, <span class="hljs-number">100</span>);
    }, time);
};

<span class="hljs-keyword">const</span> <span class="hljs-title function_">addImageDragAndDrop</span> = (<span class="hljs-params">canvas, selector, targets, callback = () =&gt; {}</span>) =&gt; {</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-8">&#x00a7;</a>
              </div>
              <h4 id="drag-and-drop-image-loading-functionality">Drag-and-Drop image loading functionality</h4>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">const</span> store = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(selector);
    <span class="hljs-keyword">const</span> timeoutDelay = <span class="hljs-number">200</span>;

    <span class="hljs-keyword">let</span> counter = <span class="hljs-number">0</span>;

    <span class="hljs-keyword">const</span> wrappers = [];
    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(canvas)) wrappers.<span class="hljs-title function_">push</span>(...canvas);
    <span class="hljs-keyword">else</span> wrappers.<span class="hljs-title function_">push</span>(canvas);

    <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(targets)) targets = [targets];

    scrawl.<span class="hljs-title function_">addNativeListener</span>([<span class="hljs-string">&#x27;dragenter&#x27;</span>, <span class="hljs-string">&#x27;dragover&#x27;</span>, <span class="hljs-string">&#x27;dragleave&#x27;</span>], <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {

        e.<span class="hljs-title function_">preventDefault</span>();
        e.<span class="hljs-title function_">stopPropagation</span>();

    }, wrappers.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">w</span> =&gt;</span> w.<span class="hljs-property">domElement</span>));

    scrawl.<span class="hljs-title function_">addNativeListener</span>(<span class="hljs-string">&#x27;drop&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {

        e.<span class="hljs-title function_">preventDefault</span>();
        e.<span class="hljs-title function_">stopPropagation</span>();

        <span class="hljs-keyword">const</span> dt = e.<span class="hljs-property">dataTransfer</span>;

        <span class="hljs-keyword">if</span> (dt) [...dt.<span class="hljs-property">files</span>].<span class="hljs-title function_">forEach</span>(addImageAsset);

    }, wrappers.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">w</span> =&gt;</span> w.<span class="hljs-property">domElement</span>));

    <span class="hljs-keyword">const</span> <span class="hljs-title function_">addImageAsset</span> = (<span class="hljs-params">file</span>) =&gt; {

        <span class="hljs-keyword">if</span> (file.<span class="hljs-property">type</span>.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&#x27;image/&#x27;</span>) === <span class="hljs-number">0</span>) {

            <span class="hljs-keyword">const</span> reader = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileReader</span>();

            reader.<span class="hljs-title function_">readAsDataURL</span>(file);

            reader.<span class="hljs-property">onloadend</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-9">&#x00a7;</a>
              </div>
              <p>Create a name for our new asset</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="hljs-keyword">const</span> name = <span class="hljs-string">`user-upload-<span class="hljs-subst">${counter}</span>`</span>;
                counter++;</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-10">&#x00a7;</a>
              </div>
              <p>Add the image to the DOM and create our asset from it</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="hljs-keyword">const</span> img = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;img&#x27;</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-11">&#x00a7;</a>
              </div>
              <p>@ts-expect-error</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                img.<span class="hljs-property">src</span> = reader.<span class="hljs-property">result</span>;
                img.<span class="hljs-property">id</span> = name;
                store.<span class="hljs-title function_">appendChild</span>(img);

                scrawl.<span class="hljs-title function_">importDomImage</span>(<span class="hljs-string">`#<span class="hljs-subst">${name}</span>`</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-12">&#x00a7;</a>
              </div>
              <p>Update our Picture entity’s asset attribute so it displays the new image</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                targets.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">target</span> =&gt;</span> {

                    <span class="hljs-keyword">if</span> (target.<span class="hljs-property">type</span> === <span class="hljs-string">&#x27;Group&#x27;</span>) {

                        target.<span class="hljs-title function_">setArtefacts</span>({
                            <span class="hljs-attr">asset</span>: name,
                        });
                    }
                    <span class="hljs-keyword">else</span> {

                        target.<span class="hljs-title function_">set</span>({
                            <span class="hljs-attr">asset</span>: name,
                        });
                    }
                });</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-13">&#x00a7;</a>
              </div>
              <p>HOW TO: set the Picture entity’s copy dimensions to take into account any difference between the old and new image’s dimensions</p>
<ul>
<li>Because of asynch stuff, we need to wait for stuff to complete before performing this functionality</li>
<li>The Picture entity copies (for the sake of our sanity) a square part of the image. Thus we shall use the new image’s shorter dimension as the copy dimension and offset the longer copy start so we are viewing the middle of it</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {

                    <span class="hljs-keyword">const</span> asset = L.<span class="hljs-property">asset</span>[name];

                    <span class="hljs-keyword">const</span> width = asset.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;width&#x27;</span>),
                        height = asset.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;height&#x27;</span>);

                    <span class="hljs-keyword">let</span> copyStartX = <span class="hljs-number">0</span>,
                        copyStartY = <span class="hljs-number">0</span>,
                        dim = <span class="hljs-number">0</span>;

                    <span class="hljs-keyword">if</span> (width &gt; height) {

                        copyStartX = (width - height) / <span class="hljs-number">2</span>;
                        dim = height;
                    }
                    <span class="hljs-keyword">else</span> {

                        copyStartY = (height - width) / <span class="hljs-number">2</span>;
                        dim = width;
                    }

                    targets.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">target</span> =&gt;</span> {

                        <span class="hljs-keyword">if</span> (target.<span class="hljs-property">type</span> === <span class="hljs-string">&#x27;Group&#x27;</span>) {

                            target.<span class="hljs-title function_">setArtefacts</span>({
                                copyStartX,
                                copyStartY,
                                <span class="hljs-attr">copyWidth</span>: dim,
                                <span class="hljs-attr">copyHeight</span>: dim,
                            });
                        }
                        <span class="hljs-keyword">else</span> {

                            target.<span class="hljs-title function_">set</span>({
                                copyStartX,
                                copyStartY,
                                <span class="hljs-attr">copyWidth</span>: dim,
                                <span class="hljs-attr">copyHeight</span>: dim,
                            });
                        }
                    })

                    <span class="hljs-keyword">if</span> (callback) <span class="hljs-built_in">setTimeout</span>(callback, timeoutDelay);
                }, timeoutDelay);
            }
        }
    };
};

<span class="hljs-keyword">const</span> <span class="hljs-title function_">addCheckerboardBackground</span> = (<span class="hljs-params">canvas, namespace</span>) =&gt; {</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-14">&#x00a7;</a>
              </div>
              <p>Namespace boilerplate</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">const</span> <span class="hljs-title function_">name</span> = (<span class="hljs-params">item</span>) =&gt; <span class="hljs-string">`<span class="hljs-subst">${namespace}</span>-<span class="hljs-subst">${item}</span>`</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-15">&#x00a7;</a>
              </div>
              <p>Create the background</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">const</span> checkerboard = canvas.<span class="hljs-title function_">buildCell</span>({
        <span class="hljs-attr">name</span>: <span class="hljs-title function_">name</span>(<span class="hljs-string">&#x27;checkerboard-background-cell&#x27;</span>),
        <span class="hljs-attr">dimensions</span>: [<span class="hljs-number">16</span>, <span class="hljs-number">16</span>],
        <span class="hljs-attr">backgroundColor</span>: <span class="hljs-string">&#x27;#999&#x27;</span>,
        <span class="hljs-attr">cleared</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">compiled</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">shown</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">useAsPattern</span>: <span class="hljs-literal">true</span>,
    });

    scrawl.<span class="hljs-title function_">makeBlock</span>({
        <span class="hljs-attr">name</span>: <span class="hljs-title function_">name</span>(<span class="hljs-string">&#x27;checkerboard-background-block-1&#x27;</span>),
        <span class="hljs-attr">group</span>: <span class="hljs-title function_">name</span>(<span class="hljs-string">&#x27;checkerboard-background-cell&#x27;</span>),
        <span class="hljs-attr">dimensions</span>: [<span class="hljs-string">&#x27;50%&#x27;</span>, <span class="hljs-string">&#x27;50%&#x27;</span>],
        <span class="hljs-attr">fillStyle</span>: <span class="hljs-string">&#x27;#bbb&#x27;</span>,
    }).<span class="hljs-title function_">clone</span>({
        <span class="hljs-attr">name</span>: <span class="hljs-title function_">name</span>(<span class="hljs-string">&#x27;checkerboard-background-block-2&#x27;</span>),
        <span class="hljs-attr">start</span>: [<span class="hljs-string">&#x27;50%&#x27;</span>, <span class="hljs-string">&#x27;50%&#x27;</span>],
    });

    checkerboard.<span class="hljs-title function_">clear</span>();
    checkerboard.<span class="hljs-title function_">compile</span>();

    scrawl.<span class="hljs-title function_">makeBlock</span>({
        <span class="hljs-attr">name</span>: <span class="hljs-title function_">name</span>(<span class="hljs-string">&#x27;checkerboard-background&#x27;</span>),
        <span class="hljs-attr">group</span>: canvas.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;baseName&#x27;</span>),
        <span class="hljs-attr">dimensions</span>: [<span class="hljs-string">&#x27;100%&#x27;</span>, <span class="hljs-string">&#x27;100%&#x27;</span>],
        <span class="hljs-attr">fillStyle</span>: <span class="hljs-title function_">name</span>(<span class="hljs-string">&#x27;checkerboard-background-cell&#x27;</span>),
    });
};

<span class="hljs-keyword">export</span> {
    reportSpeed,
    reportFullLibrary,

    killArtefact,
    killArtefactAndAnchor,
    killPolylineArtefact,
    killStyle,
    killTicker,

    addCheckerboardBackground,
    addImageDragAndDrop,
}</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
