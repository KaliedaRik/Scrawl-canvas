<!DOCTYPE html>

<html>
<head>
  <title>Demo DOM 017</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="../docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page_wrapper">
            <div id="jump_page">
              
                
                <a class="source" href="canvas-001.html">
                  ./demo/canvas-001.js
                </a>
              
                
                <a class="source" href="canvas-002.html">
                  ./demo/canvas-002.js
                </a>
              
                
                <a class="source" href="canvas-003.html">
                  ./demo/canvas-003.js
                </a>
              
                
                <a class="source" href="canvas-004.html">
                  ./demo/canvas-004.js
                </a>
              
                
                <a class="source" href="canvas-005.html">
                  ./demo/canvas-005.js
                </a>
              
                
                <a class="source" href="canvas-006.html">
                  ./demo/canvas-006.js
                </a>
              
                
                <a class="source" href="canvas-007.html">
                  ./demo/canvas-007.js
                </a>
              
                
                <a class="source" href="canvas-008.html">
                  ./demo/canvas-008.js
                </a>
              
                
                <a class="source" href="canvas-009.html">
                  ./demo/canvas-009.js
                </a>
              
                
                <a class="source" href="canvas-010.html">
                  ./demo/canvas-010.js
                </a>
              
                
                <a class="source" href="canvas-011.html">
                  ./demo/canvas-011.js
                </a>
              
                
                <a class="source" href="canvas-012.html">
                  ./demo/canvas-012.js
                </a>
              
                
                <a class="source" href="canvas-013.html">
                  ./demo/canvas-013.js
                </a>
              
                
                <a class="source" href="canvas-014.html">
                  ./demo/canvas-014.js
                </a>
              
                
                <a class="source" href="canvas-015.html">
                  ./demo/canvas-015.js
                </a>
              
                
                <a class="source" href="canvas-015a.html">
                  ./demo/canvas-015a.js
                </a>
              
                
                <a class="source" href="canvas-016.html">
                  ./demo/canvas-016.js
                </a>
              
                
                <a class="source" href="canvas-017.html">
                  ./demo/canvas-017.js
                </a>
              
                
                <a class="source" href="canvas-018.html">
                  ./demo/canvas-018.js
                </a>
              
                
                <a class="source" href="canvas-019.html">
                  ./demo/canvas-019.js
                </a>
              
                
                <a class="source" href="canvas-019a.html">
                  ./demo/canvas-019a.js
                </a>
              
                
                <a class="source" href="canvas-020.html">
                  ./demo/canvas-020.js
                </a>
              
                
                <a class="source" href="canvas-021.html">
                  ./demo/canvas-021.js
                </a>
              
                
                <a class="source" href="canvas-022.html">
                  ./demo/canvas-022.js
                </a>
              
                
                <a class="source" href="canvas-023.html">
                  ./demo/canvas-023.js
                </a>
              
                
                <a class="source" href="canvas-024.html">
                  ./demo/canvas-024.js
                </a>
              
                
                <a class="source" href="canvas-025.html">
                  ./demo/canvas-025.js
                </a>
              
                
                <a class="source" href="canvas-026.html">
                  ./demo/canvas-026.js
                </a>
              
                
                <a class="source" href="canvas-027.html">
                  ./demo/canvas-027.js
                </a>
              
                
                <a class="source" href="canvas-028.html">
                  ./demo/canvas-028.js
                </a>
              
                
                <a class="source" href="canvas-029.html">
                  ./demo/canvas-029.js
                </a>
              
                
                <a class="source" href="canvas-030.html">
                  ./demo/canvas-030.js
                </a>
              
                
                <a class="source" href="canvas-031.html">
                  ./demo/canvas-031.js
                </a>
              
                
                <a class="source" href="canvas-032.html">
                  ./demo/canvas-032.js
                </a>
              
                
                <a class="source" href="canvas-033.html">
                  ./demo/canvas-033.js
                </a>
              
                
                <a class="source" href="canvas-034.html">
                  ./demo/canvas-034.js
                </a>
              
                
                <a class="source" href="canvas-035.html">
                  ./demo/canvas-035.js
                </a>
              
                
                <a class="source" href="canvas-036.html">
                  ./demo/canvas-036.js
                </a>
              
                
                <a class="source" href="canvas-037.html">
                  ./demo/canvas-037.js
                </a>
              
                
                <a class="source" href="canvas-038.html">
                  ./demo/canvas-038.js
                </a>
              
                
                <a class="source" href="canvas-039.html">
                  ./demo/canvas-039.js
                </a>
              
                
                <a class="source" href="canvas-040.html">
                  ./demo/canvas-040.js
                </a>
              
                
                <a class="source" href="canvas-041.html">
                  ./demo/canvas-041.js
                </a>
              
                
                <a class="source" href="canvas-042.html">
                  ./demo/canvas-042.js
                </a>
              
                
                <a class="source" href="canvas-043.html">
                  ./demo/canvas-043.js
                </a>
              
                
                <a class="source" href="canvas-044.html">
                  ./demo/canvas-044.js
                </a>
              
                
                <a class="source" href="canvas-045.html">
                  ./demo/canvas-045.js
                </a>
              
                
                <a class="source" href="canvas-046.html">
                  ./demo/canvas-046.js
                </a>
              
                
                <a class="source" href="canvas-047.html">
                  ./demo/canvas-047.js
                </a>
              
                
                <a class="source" href="canvas-048.html">
                  ./demo/canvas-048.js
                </a>
              
                
                <a class="source" href="canvas-049.html">
                  ./demo/canvas-049.js
                </a>
              
                
                <a class="source" href="canvas-050.html">
                  ./demo/canvas-050.js
                </a>
              
                
                <a class="source" href="canvas-051.html">
                  ./demo/canvas-051.js
                </a>
              
                
                <a class="source" href="canvas-052.html">
                  ./demo/canvas-052.js
                </a>
              
                
                <a class="source" href="canvas-053.html">
                  ./demo/canvas-053.js
                </a>
              
                
                <a class="source" href="canvas-054.html">
                  ./demo/canvas-054.js
                </a>
              
                
                <a class="source" href="canvas-055.html">
                  ./demo/canvas-055.js
                </a>
              
                
                <a class="source" href="canvas-056.html">
                  ./demo/canvas-056.js
                </a>
              
                
                <a class="source" href="canvas-057.html">
                  ./demo/canvas-057.js
                </a>
              
                
                <a class="source" href="canvas-058.html">
                  ./demo/canvas-058.js
                </a>
              
                
                <a class="source" href="canvas-059.html">
                  ./demo/canvas-059.js
                </a>
              
                
                <a class="source" href="canvas-060.html">
                  ./demo/canvas-060.js
                </a>
              
                
                <a class="source" href="canvas-061.html">
                  ./demo/canvas-061.js
                </a>
              
                
                <a class="source" href="canvas-062.html">
                  ./demo/canvas-062.js
                </a>
              
                
                <a class="source" href="canvas-063.html">
                  ./demo/canvas-063.js
                </a>
              
                
                <a class="source" href="canvas-064.html">
                  ./demo/canvas-064.js
                </a>
              
                
                <a class="source" href="canvas-065.html">
                  ./demo/canvas-065.js
                </a>
              
                
                <a class="source" href="delaunator-001.html">
                  ./demo/delaunator-001.js
                </a>
              
                
                <a class="source" href="delaunator-002.html">
                  ./demo/delaunator-002.js
                </a>
              
                
                <a class="source" href="dom-001.html">
                  ./demo/dom-001.js
                </a>
              
                
                <a class="source" href="dom-002.html">
                  ./demo/dom-002.js
                </a>
              
                
                <a class="source" href="dom-003.html">
                  ./demo/dom-003.js
                </a>
              
                
                <a class="source" href="dom-004.html">
                  ./demo/dom-004.js
                </a>
              
                
                <a class="source" href="dom-005.html">
                  ./demo/dom-005.js
                </a>
              
                
                <a class="source" href="dom-006.html">
                  ./demo/dom-006.js
                </a>
              
                
                <a class="source" href="dom-007.html">
                  ./demo/dom-007.js
                </a>
              
                
                <a class="source" href="dom-008.html">
                  ./demo/dom-008.js
                </a>
              
                
                <a class="source" href="dom-009.html">
                  ./demo/dom-009.js
                </a>
              
                
                <a class="source" href="dom-010.html">
                  ./demo/dom-010.js
                </a>
              
                
                <a class="source" href="dom-011.html">
                  ./demo/dom-011.js
                </a>
              
                
                <a class="source" href="dom-012.html">
                  ./demo/dom-012.js
                </a>
              
                
                <a class="source" href="dom-013.html">
                  ./demo/dom-013.js
                </a>
              
                
                <a class="source" href="dom-015.html">
                  ./demo/dom-015.js
                </a>
              
                
                <a class="source" href="dom-016.html">
                  ./demo/dom-016.js
                </a>
              
                
                <a class="source" href="dom-017.html">
                  ./demo/dom-017.js
                </a>
              
                
                <a class="source" href="dom-018.html">
                  ./demo/dom-018.js
                </a>
              
                
                <a class="source" href="dom-019.html">
                  ./demo/dom-019.js
                </a>
              
                
                <a class="source" href="dom-020.html">
                  ./demo/dom-020.js
                </a>
              
                
                <a class="source" href="dom-021.html">
                  ./demo/dom-021.js
                </a>
              
                
                <a class="source" href="filters-001.html">
                  ./demo/filters-001.js
                </a>
              
                
                <a class="source" href="filters-002.html">
                  ./demo/filters-002.js
                </a>
              
                
                <a class="source" href="filters-002a.html">
                  ./demo/filters-002a.js
                </a>
              
                
                <a class="source" href="filters-003.html">
                  ./demo/filters-003.js
                </a>
              
                
                <a class="source" href="filters-004.html">
                  ./demo/filters-004.js
                </a>
              
                
                <a class="source" href="filters-005.html">
                  ./demo/filters-005.js
                </a>
              
                
                <a class="source" href="filters-006.html">
                  ./demo/filters-006.js
                </a>
              
                
                <a class="source" href="filters-007.html">
                  ./demo/filters-007.js
                </a>
              
                
                <a class="source" href="filters-008.html">
                  ./demo/filters-008.js
                </a>
              
                
                <a class="source" href="filters-009.html">
                  ./demo/filters-009.js
                </a>
              
                
                <a class="source" href="filters-010.html">
                  ./demo/filters-010.js
                </a>
              
                
                <a class="source" href="filters-011.html">
                  ./demo/filters-011.js
                </a>
              
                
                <a class="source" href="filters-012.html">
                  ./demo/filters-012.js
                </a>
              
                
                <a class="source" href="filters-013.html">
                  ./demo/filters-013.js
                </a>
              
                
                <a class="source" href="filters-014.html">
                  ./demo/filters-014.js
                </a>
              
                
                <a class="source" href="filters-015.html">
                  ./demo/filters-015.js
                </a>
              
                
                <a class="source" href="filters-016.html">
                  ./demo/filters-016.js
                </a>
              
                
                <a class="source" href="filters-017.html">
                  ./demo/filters-017.js
                </a>
              
                
                <a class="source" href="filters-018.html">
                  ./demo/filters-018.js
                </a>
              
                
                <a class="source" href="filters-019.html">
                  ./demo/filters-019.js
                </a>
              
                
                <a class="source" href="filters-020.html">
                  ./demo/filters-020.js
                </a>
              
                
                <a class="source" href="filters-021.html">
                  ./demo/filters-021.js
                </a>
              
                
                <a class="source" href="filters-022.html">
                  ./demo/filters-022.js
                </a>
              
                
                <a class="source" href="filters-023.html">
                  ./demo/filters-023.js
                </a>
              
                
                <a class="source" href="filters-024.html">
                  ./demo/filters-024.js
                </a>
              
                
                <a class="source" href="filters-025.html">
                  ./demo/filters-025.js
                </a>
              
                
                <a class="source" href="filters-026.html">
                  ./demo/filters-026.js
                </a>
              
                
                <a class="source" href="filters-027.html">
                  ./demo/filters-027.js
                </a>
              
                
                <a class="source" href="filters-028.html">
                  ./demo/filters-028.js
                </a>
              
                
                <a class="source" href="filters-101.html">
                  ./demo/filters-101.js
                </a>
              
                
                <a class="source" href="filters-102.html">
                  ./demo/filters-102.js
                </a>
              
                
                <a class="source" href="filters-103.html">
                  ./demo/filters-103.js
                </a>
              
                
                <a class="source" href="filters-104.html">
                  ./demo/filters-104.js
                </a>
              
                
                <a class="source" href="filters-105.html">
                  ./demo/filters-105.js
                </a>
              
                
                <a class="source" href="filters-501.html">
                  ./demo/filters-501.js
                </a>
              
                
                <a class="source" href="filters-502.html">
                  ./demo/filters-502.js
                </a>
              
                
                <a class="source" href="filters-503.html">
                  ./demo/filters-503.js
                </a>
              
                
                <a class="source" href="filters-504.html">
                  ./demo/filters-504.js
                </a>
              
                
                <a class="source" href="filters-505.html">
                  ./demo/filters-505.js
                </a>
              
                
                <a class="source" href="mediapipe-001.html">
                  ./demo/mediapipe-001.js
                </a>
              
                
                <a class="source" href="mediapipe-002.html">
                  ./demo/mediapipe-002.js
                </a>
              
                
                <a class="source" href="mediapipe-003.html">
                  ./demo/mediapipe-003.js
                </a>
              
                
                <a class="source" href="modules-001.html">
                  ./demo/modules-001.js
                </a>
              
                
                <a class="source" href="modules-002.html">
                  ./demo/modules-002.js
                </a>
              
                
                <a class="source" href="modules-003.html">
                  ./demo/modules-003.js
                </a>
              
                
                <a class="source" href="modules-004.html">
                  ./demo/modules-004.js
                </a>
              
                
                <a class="source" href="modules-005.html">
                  ./demo/modules-005.js
                </a>
              
                
                <a class="source" href="modules-006.html">
                  ./demo/modules-006.js
                </a>
              
                
                <a class="source" href="packets-001.html">
                  ./demo/packets-001.js
                </a>
              
                
                <a class="source" href="packets-002.html">
                  ./demo/packets-002.js
                </a>
              
                
                <a class="source" href="particles-001.html">
                  ./demo/particles-001.js
                </a>
              
                
                <a class="source" href="particles-002.html">
                  ./demo/particles-002.js
                </a>
              
                
                <a class="source" href="particles-003.html">
                  ./demo/particles-003.js
                </a>
              
                
                <a class="source" href="particles-004.html">
                  ./demo/particles-004.js
                </a>
              
                
                <a class="source" href="particles-005.html">
                  ./demo/particles-005.js
                </a>
              
                
                <a class="source" href="particles-006.html">
                  ./demo/particles-006.js
                </a>
              
                
                <a class="source" href="particles-007.html">
                  ./demo/particles-007.js
                </a>
              
                
                <a class="source" href="particles-008.html">
                  ./demo/particles-008.js
                </a>
              
                
                <a class="source" href="particles-009.html">
                  ./demo/particles-009.js
                </a>
              
                
                <a class="source" href="particles-010.html">
                  ./demo/particles-010.js
                </a>
              
                
                <a class="source" href="particles-011.html">
                  ./demo/particles-011.js
                </a>
              
                
                <a class="source" href="particles-012.html">
                  ./demo/particles-012.js
                </a>
              
                
                <a class="source" href="particles-013.html">
                  ./demo/particles-013.js
                </a>
              
                
                <a class="source" href="particles-014.html">
                  ./demo/particles-014.js
                </a>
              
                
                <a class="source" href="particles-015.html">
                  ./demo/particles-015.js
                </a>
              
                
                <a class="source" href="particles-016.html">
                  ./demo/particles-016.js
                </a>
              
                
                <a class="source" href="rapier-001.html">
                  ./demo/rapier-001.js
                </a>
              
                
                <a class="source" href="snippets-001.html">
                  ./demo/snippets-001.js
                </a>
              
                
                <a class="source" href="snippets-002.html">
                  ./demo/snippets-002.js
                </a>
              
                
                <a class="source" href="snippets-003.html">
                  ./demo/snippets-003.js
                </a>
              
                
                <a class="source" href="snippets-004.html">
                  ./demo/snippets-004.js
                </a>
              
                
                <a class="source" href="snippets-005.html">
                  ./demo/snippets-005.js
                </a>
              
                
                <a class="source" href="snippets-006.html">
                  ./demo/snippets-006.js
                </a>
              
                
                <a class="source" href="tensorflow-001.html">
                  ./demo/tensorflow-001.js
                </a>
              
                
                <a class="source" href="tensorflow-002.html">
                  ./demo/tensorflow-002.js
                </a>
              
                
                <a class="source" href="utilities.html">
                  ./demo/utilities.js
                </a>
              
            </div>
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-1">&#x00a7;</a>
              </div>
              <h1 id="demo-dom-017">Demo DOM 017</h1>
<p>Testing getCanvas(), getStack() functionality</p>

            </div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-2">&#x00a7;</a>
              </div>
              <p><a href="../../demo/dom-017.html">Run code</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> scrawl <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../source/scrawl.js&#x27;</span>;

<span class="hljs-keyword">import</span> { reportSpeed, reportFullLibrary } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./utilities.js&#x27;</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-3">&#x00a7;</a>
              </div>
              <h4 id="scene-setup">Scene setup</h4>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">const</span> canvasParent = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;#canvas-parent&#x27;</span>);
<span class="hljs-keyword">const</span> canvasSwitchButton = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;#canvas-switch&#x27;</span>);
<span class="hljs-keyword">const</span> canvasReplaceButton = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;#canvas-replace&#x27;</span>);
<span class="hljs-keyword">const</span> canvasRemoveButton = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;#canvas-remove&#x27;</span>);

<span class="hljs-keyword">const</span> stackParent = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;#stack-parent&#x27;</span>);
<span class="hljs-keyword">const</span> stackSwitchButton = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;#stack-switch&#x27;</span>);
<span class="hljs-keyword">const</span> stackReplaceButton = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;#stack-replace&#x27;</span>);
<span class="hljs-keyword">const</span> stackRemoveButton = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;#stack-remove&#x27;</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-4">&#x00a7;</a>
              </div>
              <p>KeyboardZones and DragZones don’t integrate with their canvas/stack parents - they’re useful add-ons rather than an integrated part of the system. So we need to have an elegant way to handle them.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">const</span> dragZones = {};</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-5">&#x00a7;</a>
              </div>
              <h4 id="user-interaction-canvas-test">User interaction (CANVAS test)</h4>
<h2 id="switch-canvas">Switch canvas</h2>

            </div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-6">&#x00a7;</a>
              </div>
              <p>Load a new canvas with a different namespace into the parent element. Emulates a react component render when the component details have changed. For example:</p>
<ul>
<li>Start with the square canvas - onboard and capture details about that canvas and associated artefacts/objects in the libarary</li>
<li>Switch to the round canvas - capture details about that canvas and associated artefacts/objects in the libarary. <strong>Details about the square canvas will not be removed from the library</strong> without specific instruction even though the related DOM canvas no longer exists</li>
<li>Switch back to the square canvas - it is at this point that SC should recognise the details it holds about the previous canvas are no longer relevant, purge everything related to that old canvas from the library, and then repopulate with new data</li>
<li>Existing functionality for Canvas.kill() is to delete the associated DOM data structures for that canvas from the page - though the canvas itself was removed some time prior and SC did nothing about it. Make sure that any errors emerging from that activity are properly captured and handled</li>
</ul>

            </div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-7">&#x00a7;</a>
              </div>
              <h2 id="replace-canvas">Replace canvas</h2>

            </div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-8">&#x00a7;</a>
              </div>
              <p>Load a new canvas with the same namespace into the parent element. Emulates a react component render when the component details have NOT changed - the component is rendered again because something else in the page has triggered a more general render. For example:</p>
<ul>
<li>Start with the square canvas - onboard and capture details about that canvas and associated artefacts/objects in the libarary</li>
<li>Replace that canvas with another square canvas. SC needs to identify that while details about the canvas still exist, that canvas has gone and the new canvas needs to be processed and data about it - and all related artefacts/objects - stored in the library</li>
</ul>

            </div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-9">&#x00a7;</a>
              </div>
              <h2 id="remove-canvas">Remove canvas</h2>

            </div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-10">&#x00a7;</a>
              </div>
              <p>Purge everything relating to the current canvas’s namespace from the SC library</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>

<span class="hljs-keyword">const</span> <span class="hljs-title function_">insertCanvas</span> = (<span class="hljs-params">element, parent</span>) =&gt; {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;inserting a canvas into the DOM parent&#x27;</span>);

    parent.<span class="hljs-property">innerHTML</span> = element;
};

<span class="hljs-keyword">const</span> <span class="hljs-title function_">buildSquareCanvas</span> = (<span class="hljs-params">namespace</span>) =&gt; {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;build a new square canvas element&#x27;</span>, namespace);

    <span class="hljs-keyword">const</span> <span class="hljs-title function_">name</span> = n =&gt; <span class="hljs-string">`<span class="hljs-subst">${namespace}</span>-<span class="hljs-subst">${n}</span>`</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-11">&#x00a7;</a>
              </div>
              <p>build canvas</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">const</span> c = <span class="hljs-string">`
    &lt;canvas 
      id=<span class="hljs-subst">${namespace}</span>
      width=&quot;400&quot;
      height=&quot;400&quot;
      data-base-background-color=&quot;aliceblue&quot;
    &gt;&lt;/canvas&gt;
    `</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-12">&#x00a7;</a>
              </div>
              <p>insert and capture</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-title function_">insertCanvas</span>(c, canvasParent);

    <span class="hljs-keyword">const</span> canvas = <span class="hljs-title function_">captureCanvasIntoLibrary</span>(namespace);</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-13">&#x00a7;</a>
              </div>
              <p>create required artefacts/objects</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> (canvas != <span class="hljs-literal">null</span>) {

        scrawl.<span class="hljs-title function_">makeGradient</span>({
            <span class="hljs-attr">name</span>: <span class="hljs-title function_">name</span>(<span class="hljs-string">&#x27;gradient&#x27;</span>),
            <span class="hljs-attr">end</span>: [<span class="hljs-string">&#x27;100%&#x27;</span>, <span class="hljs-string">&#x27;100%&#x27;</span>],
            <span class="hljs-attr">colors</span>: [
                [<span class="hljs-number">0</span>, <span class="hljs-string">&#x27;red&#x27;</span>],
                [<span class="hljs-number">999</span>, <span class="hljs-string">&#x27;blue&#x27;</span>],
            ],
            <span class="hljs-attr">colorSpace</span>: <span class="hljs-string">&#x27;OKLAB&#x27;</span>,
        });

        scrawl.<span class="hljs-title function_">makeFilter</span>({
            <span class="hljs-attr">name</span>: <span class="hljs-title function_">name</span>(<span class="hljs-string">&#x27;filter&#x27;</span>),
            <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;randomNoise&#x27;</span>,
            <span class="hljs-attr">width</span>: <span class="hljs-number">20</span>,
            <span class="hljs-attr">height</span>: <span class="hljs-number">20</span>,
            <span class="hljs-attr">level</span>: <span class="hljs-number">1</span>,
        });

        scrawl.<span class="hljs-title function_">makeBlock</span>({
            <span class="hljs-attr">name</span>: <span class="hljs-title function_">name</span>(<span class="hljs-string">&#x27;block&#x27;</span>),
            <span class="hljs-attr">start</span>: [<span class="hljs-string">&#x27;center&#x27;</span>, <span class="hljs-string">&#x27;center&#x27;</span>],
            <span class="hljs-attr">handle</span>: [<span class="hljs-string">&#x27;center&#x27;</span>, <span class="hljs-string">&#x27;center&#x27;</span>],
            <span class="hljs-attr">dimensions</span>: [<span class="hljs-string">&#x27;50%&#x27;</span>, <span class="hljs-string">&#x27;50%&#x27;</span>],
            <span class="hljs-attr">fillStyle</span>: <span class="hljs-title function_">name</span>(<span class="hljs-string">&#x27;gradient&#x27;</span>),
            <span class="hljs-attr">lockFillStyleToEntity</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">lineWidth</span>: <span class="hljs-number">2</span>,
            <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;fillThenDraw&#x27;</span>,
            <span class="hljs-attr">delta</span>: {
                <span class="hljs-attr">roll</span>: <span class="hljs-number">0.2</span>,
            },
            <span class="hljs-attr">filters</span>: [<span class="hljs-title function_">name</span>(<span class="hljs-string">&#x27;filter&#x27;</span>)],
            <span class="hljs-attr">anchor</span>: {
                <span class="hljs-attr">name</span>: <span class="hljs-title function_">name</span>(<span class="hljs-string">&#x27;wikipedia-link&#x27;</span>),
                <span class="hljs-attr">href</span>: <span class="hljs-string">&#x27;https://en.wikipedia.org/wiki/Square&#x27;</span>,
                <span class="hljs-attr">description</span>: <span class="hljs-string">&#x27;Link to the Wikipedia article on squares (opens in new tab)&#x27;</span>,
            },</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-14">&#x00a7;</a>
              </div>
              <p>@ts-expect-error</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-attr">onEnter</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) { <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">set</span>({ <span class="hljs-attr">lineWidth</span>: <span class="hljs-number">6</span> }) },</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-15">&#x00a7;</a>
              </div>
              <p>@ts-expect-error</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-attr">onLeave</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) { <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">set</span>({ <span class="hljs-attr">lineWidth</span>: <span class="hljs-number">2</span> }) },</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-16">&#x00a7;</a>
              </div>
              <p>@ts-expect-error</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-attr">onUp</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) { <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">clickAnchor</span>() },
        });

        scrawl.<span class="hljs-title function_">addListener</span>(<span class="hljs-string">&#x27;move&#x27;</span>, <span class="hljs-function">() =&gt;</span> canvas.<span class="hljs-title function_">cascadeEventAction</span>(<span class="hljs-string">&#x27;move&#x27;</span>), canvas.<span class="hljs-property">domElement</span>);

        scrawl.<span class="hljs-title function_">addNativeListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
            <span class="hljs-keyword">if</span> (canvas.<span class="hljs-property">here</span>.<span class="hljs-property">active</span>) canvas.<span class="hljs-title function_">cascadeEventAction</span>(<span class="hljs-string">&#x27;up&#x27;</span>);
        }, canvas.<span class="hljs-property">domElement</span>);

        scrawl.<span class="hljs-title function_">makeRender</span>({
            <span class="hljs-attr">name</span>: <span class="hljs-title function_">name</span>(<span class="hljs-string">&#x27;animation&#x27;</span>),
            <span class="hljs-attr">target</span>: canvas,
            <span class="hljs-attr">observer</span>: <span class="hljs-literal">true</span>,
        });

        scrawl.<span class="hljs-title function_">makeTween</span>({
            <span class="hljs-attr">name</span>: <span class="hljs-title function_">name</span>(<span class="hljs-string">&#x27;tween&#x27;</span>),
            <span class="hljs-attr">cycles</span>: <span class="hljs-number">0</span>,
            <span class="hljs-attr">duration</span>: <span class="hljs-number">5000</span>,
            <span class="hljs-attr">targets</span>: <span class="hljs-title function_">name</span>(<span class="hljs-string">&#x27;block&#x27;</span>),
            <span class="hljs-attr">definitions</span>: [{
                <span class="hljs-attr">attribute</span>: <span class="hljs-string">&#x27;scale&#x27;</span>,
                <span class="hljs-attr">start</span>: <span class="hljs-number">0.8</span>,
                <span class="hljs-attr">end</span>: <span class="hljs-number">1.2</span>,
                <span class="hljs-attr">engine</span>: <span class="hljs-string">&#x27;easeOutIn&#x27;</span>,
            }],
            <span class="hljs-attr">reverseOnCycleEnd</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">observer</span>: <span class="hljs-title function_">name</span>(<span class="hljs-string">&#x27;animation&#x27;</span>),
        }).<span class="hljs-title function_">run</span>();
    }
};

<span class="hljs-keyword">const</span> <span class="hljs-title function_">buildCircleCanvas</span> = (<span class="hljs-params">namespace</span>) =&gt; {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;build a new circle canvas element&#x27;</span>, namespace);

    <span class="hljs-keyword">const</span> <span class="hljs-title function_">name</span> = n =&gt; <span class="hljs-string">`<span class="hljs-subst">${namespace}</span>-<span class="hljs-subst">${n}</span>`</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-17">&#x00a7;</a>
              </div>
              <p>build canvas</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">const</span> c = <span class="hljs-string">`
    &lt;canvas 
      id=<span class="hljs-subst">${namespace}</span>
      width=&quot;400&quot;
      height=&quot;400&quot;
      data-base-background-color=&quot;aliceblue&quot;
    &gt;&lt;/canvas&gt;
    `</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-18">&#x00a7;</a>
              </div>
              <p>insert and capture</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-title function_">insertCanvas</span>(c, canvasParent);

    <span class="hljs-keyword">const</span> canvas = <span class="hljs-title function_">captureCanvasIntoLibrary</span>(namespace);</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-19">&#x00a7;</a>
              </div>
              <p>create required artefacts/objects</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> (canvas != <span class="hljs-literal">null</span>) {

        scrawl.<span class="hljs-title function_">makeGradient</span>({
            <span class="hljs-attr">name</span>: <span class="hljs-title function_">name</span>(<span class="hljs-string">&#x27;gradient&#x27;</span>),
            <span class="hljs-attr">end</span>: [<span class="hljs-string">&#x27;100%&#x27;</span>, <span class="hljs-string">&#x27;100%&#x27;</span>],
            <span class="hljs-attr">colors</span>: [
                [<span class="hljs-number">0</span>, <span class="hljs-string">&#x27;green&#x27;</span>],
                [<span class="hljs-number">999</span>, <span class="hljs-string">&#x27;orange&#x27;</span>],
            ],
            <span class="hljs-attr">colorSpace</span>: <span class="hljs-string">&#x27;OKLAB&#x27;</span>,
        });

        scrawl.<span class="hljs-title function_">makeFilter</span>({
            <span class="hljs-attr">name</span>: <span class="hljs-title function_">name</span>(<span class="hljs-string">&#x27;filter&#x27;</span>),
            <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;randomNoise&#x27;</span>,
            <span class="hljs-attr">width</span>: <span class="hljs-number">20</span>,
            <span class="hljs-attr">height</span>: <span class="hljs-number">20</span>,
            <span class="hljs-attr">level</span>: <span class="hljs-number">1</span>,
        });

        scrawl.<span class="hljs-title function_">makeWheel</span>({
            <span class="hljs-attr">name</span>: <span class="hljs-title function_">name</span>(<span class="hljs-string">&#x27;wheel&#x27;</span>),
            <span class="hljs-attr">start</span>: [<span class="hljs-string">&#x27;center&#x27;</span>, <span class="hljs-string">&#x27;center&#x27;</span>],
            <span class="hljs-attr">handle</span>: [<span class="hljs-string">&#x27;center&#x27;</span>, <span class="hljs-string">&#x27;center&#x27;</span>],
            <span class="hljs-attr">startAngle</span>: <span class="hljs-number">30</span>,
            <span class="hljs-attr">endAngle</span>: -<span class="hljs-number">30</span>,
            <span class="hljs-attr">radius</span>: <span class="hljs-string">&#x27;25%&#x27;</span>,
            <span class="hljs-attr">fillStyle</span>: <span class="hljs-title function_">name</span>(<span class="hljs-string">&#x27;gradient&#x27;</span>),
            <span class="hljs-attr">lockFillStyleToEntity</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">lineWidth</span>: <span class="hljs-number">2</span>,
            <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;fillThenDraw&#x27;</span>,
            <span class="hljs-attr">delta</span>: {
                <span class="hljs-attr">roll</span>: <span class="hljs-number">0.2</span>,
            },
            <span class="hljs-attr">filters</span>: [<span class="hljs-title function_">name</span>(<span class="hljs-string">&#x27;filter&#x27;</span>)],
            <span class="hljs-attr">anchor</span>: {
                <span class="hljs-attr">name</span>: <span class="hljs-title function_">name</span>(<span class="hljs-string">&#x27;wikipedia-link&#x27;</span>),
                <span class="hljs-attr">href</span>: <span class="hljs-string">&#x27;https://en.wikipedia.org/wiki/Circle&#x27;</span>,
                <span class="hljs-attr">description</span>: <span class="hljs-string">&#x27;Link to the Wikipedia article on circles (opens in new tab)&#x27;</span>,
            },</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-20">&#x00a7;</a>
              </div>
              <p>@ts-expect-error</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-attr">onEnter</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) { <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">set</span>({ <span class="hljs-attr">lineWidth</span>: <span class="hljs-number">6</span> }) },</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-21">&#x00a7;</a>
              </div>
              <p>@ts-expect-error</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-attr">onLeave</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) { <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">set</span>({ <span class="hljs-attr">lineWidth</span>: <span class="hljs-number">2</span> }) },</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-22">&#x00a7;</a>
              </div>
              <p>@ts-expect-error</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-attr">onUp</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) { <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">clickAnchor</span>() },
        });

        scrawl.<span class="hljs-title function_">addListener</span>(<span class="hljs-string">&#x27;move&#x27;</span>, <span class="hljs-function">() =&gt;</span> canvas.<span class="hljs-title function_">cascadeEventAction</span>(<span class="hljs-string">&#x27;move&#x27;</span>), canvas.<span class="hljs-property">domElement</span>);

        scrawl.<span class="hljs-title function_">addNativeListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
            <span class="hljs-keyword">if</span> (canvas.<span class="hljs-property">here</span>.<span class="hljs-property">active</span>) canvas.<span class="hljs-title function_">cascadeEventAction</span>(<span class="hljs-string">&#x27;up&#x27;</span>);
        }, canvas.<span class="hljs-property">domElement</span>);

        scrawl.<span class="hljs-title function_">makeRender</span>({
            <span class="hljs-attr">name</span>: <span class="hljs-title function_">name</span>(<span class="hljs-string">&#x27;animation&#x27;</span>),
            <span class="hljs-attr">target</span>: canvas,
            <span class="hljs-attr">observer</span>: <span class="hljs-literal">true</span>,
        });

        scrawl.<span class="hljs-title function_">makeTween</span>({
            <span class="hljs-attr">name</span>: <span class="hljs-title function_">name</span>(<span class="hljs-string">&#x27;tween&#x27;</span>),
            <span class="hljs-attr">cycles</span>: <span class="hljs-number">0</span>,
            <span class="hljs-attr">duration</span>: <span class="hljs-number">5000</span>,
            <span class="hljs-attr">targets</span>: <span class="hljs-title function_">name</span>(<span class="hljs-string">&#x27;wheel&#x27;</span>),
            <span class="hljs-attr">definitions</span>: [{
                <span class="hljs-attr">attribute</span>: <span class="hljs-string">&#x27;scale&#x27;</span>,
                <span class="hljs-attr">start</span>: <span class="hljs-number">0.8</span>,
                <span class="hljs-attr">end</span>: <span class="hljs-number">1.2</span>,
                <span class="hljs-attr">engine</span>: <span class="hljs-string">&#x27;easeOutIn&#x27;</span>,
            }],
            <span class="hljs-attr">reverseOnCycleEnd</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">observer</span>: <span class="hljs-title function_">name</span>(<span class="hljs-string">&#x27;animation&#x27;</span>),
        }).<span class="hljs-title function_">run</span>();
    }
};

<span class="hljs-keyword">const</span> <span class="hljs-title function_">captureCanvasIntoLibrary</span> = (<span class="hljs-params">namespace</span>) =&gt; {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;capture the new canvas into the library:&#x27;</span>, namespace);

    <span class="hljs-keyword">return</span> scrawl.<span class="hljs-title function_">getCanvas</span>(namespace);
};

<span class="hljs-keyword">const</span> <span class="hljs-title function_">swapCanvases</span> = (<span class="hljs-params"></span>) =&gt; {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;swap the canvases!&#x27;</span>);

    <span class="hljs-keyword">if</span> (currentCanvas === squareCanvasNamespace) {

        currentCanvas = circleCanvasNamespace;
        <span class="hljs-title function_">buildCircleCanvas</span>(currentCanvas);
    }
    <span class="hljs-keyword">else</span> {

        currentCanvas = squareCanvasNamespace;
        <span class="hljs-title function_">buildSquareCanvas</span>(currentCanvas);
    }
};

<span class="hljs-keyword">const</span> <span class="hljs-title function_">reloadCanvas</span> = (<span class="hljs-params"></span>) =&gt; {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;reload the current canvas:&#x27;</span>, currentCanvas);

    <span class="hljs-keyword">if</span> (currentCanvas === squareCanvasNamespace) <span class="hljs-title function_">buildSquareCanvas</span>(currentCanvas);
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (currentCanvas === circleCanvasNamespace) <span class="hljs-title function_">buildCircleCanvas</span>(currentCanvas);
    <span class="hljs-keyword">else</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;nothing to reload&#x27;</span>);
};

<span class="hljs-keyword">const</span> <span class="hljs-title function_">removeCanvas</span> = (<span class="hljs-params"></span>) =&gt; {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;remove the current canvas:&#x27;</span>, currentCanvas);

    scrawl.<span class="hljs-property">library</span>.<span class="hljs-title function_">purge</span>(currentCanvas);
    currentCanvas = noCanvas;
};</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-23">&#x00a7;</a>
              </div>
              <p>Initial display</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">const</span> squareCanvasNamespace = <span class="hljs-string">&#x27;my-square-canvas&#x27;</span>;
<span class="hljs-keyword">const</span> circleCanvasNamespace = <span class="hljs-string">&#x27;my-circle-canvas&#x27;</span>;
<span class="hljs-keyword">const</span> noCanvas = <span class="hljs-string">&#x27;&#x27;</span>;

<span class="hljs-keyword">let</span> currentCanvas = squareCanvasNamespace;

<span class="hljs-title function_">buildSquareCanvas</span>(squareCanvasNamespace);

scrawl.<span class="hljs-title function_">addNativeListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, swapCanvases, canvasSwitchButton);
scrawl.<span class="hljs-title function_">addNativeListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, reloadCanvas, canvasReplaceButton);
scrawl.<span class="hljs-title function_">addNativeListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, removeCanvas, canvasRemoveButton);</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-24">&#x00a7;</a>
              </div>
              <h4 id="user-interaction-stack-test">User interaction (STACK test)</h4>
<h2 id="switch-stack">Switch stack</h2>

            </div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-25">&#x00a7;</a>
              </div>
              <p>Load a new stack with a different namespace into the parent element. Emulates a react component render when the component details have changed. For example:</p>
<ul>
<li>Start with the stack1 - onboard and capture details about that stack and associated artefacts/objects in the libarary</li>
<li>Switch to the stack2 - capture details about that stack and associated artefacts/objects in the libarary. <strong>Details about the stack1 will not be removed from the library</strong> without specific instruction even though the related DOM stack no longer exists</li>
<li>Switch back to the stack1 - it is at this point that SC should recognise the details it holds about the previous stack are no longer relevant, purge everything related to that old stack from the library, and then repopulate with new data</li>
<li>Existing functionality for Stack.kill() is to delete the associated DOM data structures for that stack from the page - though the stack itself was removed some time prior and SC did nothing about it. Make sure that any errors emerging from that activity are properly captured and handled</li>
</ul>

            </div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-26">&#x00a7;</a>
              </div>
              <h2 id="replace-stack">Replace stack</h2>

            </div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-27">&#x00a7;</a>
              </div>
              <p>Load a new stack with the same namespace into the parent element. Emulates a react component render when the component details have NOT changed - the component is rendered again because something else in the page has triggered a more general render. For example:</p>
<ul>
<li>Start with the stack1 - onboard and capture details about that stack and associated artefacts/objects in the libarary</li>
<li>Replace that stack with another stack1. SC needs to identify that while details about the stack still exist, that stack has gone and the new stack needs to be processed and data about it - and all related artefacts/objects - stored in the library</li>
</ul>

            </div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-28">&#x00a7;</a>
              </div>
              <h2 id="remove-stack">Remove stack</h2>

            </div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-29">&#x00a7;</a>
              </div>
              <p>Purge everything relating to the current stack’s namespace from the SC library</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">insertStack</span> = (<span class="hljs-params">element, parent</span>) =&gt; {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;inserting a stack into the DOM parent&#x27;</span>);

    parent.<span class="hljs-property">innerHTML</span> = element;
};

<span class="hljs-keyword">const</span> <span class="hljs-title function_">buildStack1</span> = (<span class="hljs-params">namespace</span>) =&gt; {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;build a new stack1 element&#x27;</span>, namespace);

    <span class="hljs-keyword">const</span> <span class="hljs-title function_">name</span> = n =&gt; <span class="hljs-string">`<span class="hljs-subst">${namespace}</span>-<span class="hljs-subst">${n}</span>`</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-30">&#x00a7;</a>
              </div>
              <p>build stack</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">const</span> s = <span class="hljs-string">`
&lt;div id=&quot;<span class="hljs-subst">${namespace}</span>&quot; data-scrawl-stack&gt;

    &lt;div id=&quot;<span class="hljs-subst">${name(<span class="hljs-string">&#x27;simple-svg&#x27;</span>)}</span>&quot;&gt;
        &lt;svg 
            width=&quot;200px&quot; 
            height=&quot;150px&quot; 
            xmlns=&quot;http://www.w3.org/2000/svg&quot;
            viewbox=&quot;0 0 400 300&quot;&gt;

            &lt;rect width=&quot;100%&quot; height=&quot;100%&quot; fill=&quot;red&quot; /&gt;
            &lt;circle cx=&quot;100%&quot; cy=&quot;100%&quot; r=&quot;150&quot; fill=&quot;blue&quot; stroke=&quot;black&quot; /&gt;
            &lt;polygon points=&quot;120,0 240,225 0,225&quot; fill=&quot;green&quot;/&gt;
            &lt;text x=&quot;50&quot; y=&quot;100&quot; font-family=&quot;Verdana&quot; font-size=&quot;55&quot; fill=&quot;white&quot; stroke=&quot;black&quot; stroke-width=&quot;2&quot;&gt;Hello!&lt;/text&gt;
        &lt;/svg&gt;
    &lt;/div&gt;
    &lt;div id=&quot;<span class="hljs-subst">${name(<span class="hljs-string">&#x27;dom-element&#x27;</span>)}</span>&quot;&gt;
        &lt;p&gt;Drag and drop the elements around the stack.&lt;/p&gt;
        &lt;ul&gt;
            &lt;li&gt;Tomatoes&lt;/li&gt;
            &lt;li&gt;Cauliflower&lt;/li&gt;
            &lt;li&gt;Broccoli&lt;/li&gt;
        &lt;/ul&gt;
    &lt;/div&gt;
&lt;/div&gt;
    `</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-31">&#x00a7;</a>
              </div>
              <p>insert and capture</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-title function_">insertStack</span>(s, stackParent);

    <span class="hljs-keyword">const</span> stack = <span class="hljs-title function_">captureStackIntoLibrary</span>(namespace);</pre></div></div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-32">&#x00a7;</a>
              </div>
              <p>create required artefacts/objects</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> (stack != <span class="hljs-literal">null</span>) {

        stack.<span class="hljs-title function_">set</span>({
            <span class="hljs-attr">dimensions</span>: [<span class="hljs-number">400</span>, <span class="hljs-number">400</span>],
            <span class="hljs-attr">perspectiveZ</span>: <span class="hljs-number">1200</span>,
            <span class="hljs-attr">css</span>: {
                <span class="hljs-attr">margin</span>: <span class="hljs-string">&#x27;1em auto&#x27;</span>,
                <span class="hljs-attr">backgroundColor</span>: <span class="hljs-string">&#x27;lightgray&#x27;</span>,
                <span class="hljs-attr">borderRadius</span>: <span class="hljs-string">&#x27;10px&#x27;</span>,
            },
        });</pre></div></div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-33">&#x00a7;</a>
              </div>
              <p>Kill any old dragzone</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> (dragZones[namespace]) dragZones[namespace]();

        dragZones[namespace] = scrawl.<span class="hljs-title function_">makeDragZone</span>({
            <span class="hljs-attr">zone</span>: stack,
            <span class="hljs-attr">endOn</span>: [<span class="hljs-string">&#x27;up&#x27;</span>, <span class="hljs-string">&#x27;leave&#x27;</span>],
            <span class="hljs-attr">preventTouchDefaultWhenDragging</span>: <span class="hljs-literal">true</span>,
        });

        <span class="hljs-keyword">const</span> svg = scrawl.<span class="hljs-property">library</span>.<span class="hljs-property">artefact</span>[<span class="hljs-title function_">name</span>(<span class="hljs-string">&#x27;simple-svg&#x27;</span>)];
        <span class="hljs-keyword">if</span> (svg) {
            svg.<span class="hljs-title function_">set</span>({
                <span class="hljs-attr">start</span>: [<span class="hljs-string">&#x27;10%&#x27;</span>, <span class="hljs-string">&#x27;10%&#x27;</span>],
                <span class="hljs-attr">width</span>: <span class="hljs-number">200</span>,
                <span class="hljs-attr">roll</span>: -<span class="hljs-number">10</span>,
                <span class="hljs-attr">yaw</span>: <span class="hljs-number">40</span>,
                <span class="hljs-attr">css</span>: {
                    <span class="hljs-attr">border</span>: <span class="hljs-string">&#x27;1px dashed black&#x27;</span>,
                    <span class="hljs-attr">boxSizing</span>: <span class="hljs-string">&#x27;border-box&#x27;</span>,
                },
            });
        }

        <span class="hljs-keyword">const</span> domEl = scrawl.<span class="hljs-property">library</span>.<span class="hljs-property">artefact</span>[<span class="hljs-title function_">name</span>(<span class="hljs-string">&#x27;dom-element&#x27;</span>)];
        <span class="hljs-keyword">if</span> (domEl) {
            domEl.<span class="hljs-title function_">set</span>({
                <span class="hljs-attr">start</span>: [<span class="hljs-string">&#x27;70%&#x27;</span>, <span class="hljs-string">&#x27;70%&#x27;</span>],
                <span class="hljs-attr">handle</span>: [<span class="hljs-string">&#x27;50%&#x27;</span>, <span class="hljs-string">&#x27;50%&#x27;</span>],
                <span class="hljs-attr">dimensions</span>: [<span class="hljs-number">200</span>, <span class="hljs-number">200</span>],
                <span class="hljs-attr">roll</span>: <span class="hljs-number">10</span>,
                <span class="hljs-attr">yaw</span>: -<span class="hljs-number">35</span>,
                <span class="hljs-attr">css</span>: {
                    <span class="hljs-attr">border</span>: <span class="hljs-string">&#x27;1px dashed green&#x27;</span>,
                    <span class="hljs-attr">padding</span>: <span class="hljs-string">&#x27;0.5em&#x27;</span>,
                    <span class="hljs-attr">borderRadius</span>: <span class="hljs-string">&#x27;10px&#x27;</span>,
                    <span class="hljs-attr">display</span>: <span class="hljs-string">&#x27;grid&#x27;</span>,
                    <span class="hljs-attr">justifyContents</span>: <span class="hljs-string">&#x27;center&#x27;</span>,
                    <span class="hljs-attr">alignItems</span>: <span class="hljs-string">&#x27;center&#x27;</span>,
                    <span class="hljs-attr">backgroundColor</span>: <span class="hljs-string">&#x27;beige&#x27;</span>
                },
            });
        }

        scrawl.<span class="hljs-title function_">makeRender</span>({
            <span class="hljs-attr">name</span>: <span class="hljs-title function_">name</span>(<span class="hljs-string">&#x27;animation&#x27;</span>),
            <span class="hljs-attr">target</span>: stack,
            <span class="hljs-attr">observer</span>: <span class="hljs-literal">true</span>,
        });
    }
};

<span class="hljs-keyword">const</span> <span class="hljs-title function_">buildStack2</span> = (<span class="hljs-params">namespace</span>) =&gt; {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;build a new stack1 element&#x27;</span>, namespace);

    <span class="hljs-keyword">const</span> <span class="hljs-title function_">name</span> = n =&gt; <span class="hljs-string">`<span class="hljs-subst">${namespace}</span>-<span class="hljs-subst">${n}</span>`</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-34">&#x00a7;</a>
              </div>
              <p>build stack</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">const</span> s = <span class="hljs-string">`
&lt;div id=&quot;<span class="hljs-subst">${namespace}</span>&quot; data-scrawl-stack&gt;
    &lt;canvas 
      id=<span class="hljs-subst">${name(<span class="hljs-string">&#x27;canvas&#x27;</span>)}</span>
      width=&quot;400&quot;
      height=&quot;400&quot;
      data-base-background-color=&quot;honeydew&quot;
    &gt;&lt;/canvas&gt;
&lt;/div&gt;
    `</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-35">&#x00a7;</a>
              </div>
              <p>insert and capture</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-title function_">insertStack</span>(s, stackParent);</pre></div></div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-36">&#x00a7;</a>
              </div>
              <p>Note: stacks don’t capture any canvases they may contain</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">const</span> stack = <span class="hljs-title function_">captureStackIntoLibrary</span>(namespace);
    <span class="hljs-keyword">const</span> canvas = <span class="hljs-title function_">captureCanvasIntoLibrary</span>(<span class="hljs-title function_">name</span>(<span class="hljs-string">&#x27;canvas&#x27;</span>));</pre></div></div>
            
        </li>
        
        
        <li id="section-37">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-37">&#x00a7;</a>
              </div>
              <p>create required artefacts/objects</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> (stack != <span class="hljs-literal">null</span> &amp;&amp; canvas != <span class="hljs-literal">null</span>) {

        stack.<span class="hljs-title function_">set</span>({
            <span class="hljs-attr">dimensions</span>: [<span class="hljs-number">400</span>, <span class="hljs-number">400</span>],
            <span class="hljs-attr">perspectiveZ</span>: <span class="hljs-number">1200</span>,
            <span class="hljs-attr">css</span>: {
                <span class="hljs-attr">margin</span>: <span class="hljs-string">&#x27;1em auto&#x27;</span>,
                <span class="hljs-attr">backgroundColor</span>: <span class="hljs-string">&#x27;darkslategray&#x27;</span>,
                <span class="hljs-attr">borderRadius</span>: <span class="hljs-string">&#x27;10px&#x27;</span>,
            },
        });

        canvas.<span class="hljs-title function_">set</span>({
            <span class="hljs-attr">start</span>: [<span class="hljs-string">&#x27;center&#x27;</span>, <span class="hljs-string">&#x27;center&#x27;</span>],
            <span class="hljs-attr">handle</span>: [<span class="hljs-string">&#x27;center&#x27;</span>, <span class="hljs-string">&#x27;center&#x27;</span>],
            <span class="hljs-attr">trackHere</span>: <span class="hljs-string">&#x27;local&#x27;</span>,
            <span class="hljs-attr">delta</span>: {
                <span class="hljs-attr">pitch</span>: <span class="hljs-number">0.25</span>,
                <span class="hljs-attr">yaw</span>: <span class="hljs-number">0.1</span>,
                <span class="hljs-attr">roll</span>: <span class="hljs-number">0.08</span>,
            },
        });

        scrawl.<span class="hljs-title function_">makeBlock</span>({
            <span class="hljs-attr">name</span>: <span class="hljs-title function_">name</span>(<span class="hljs-string">&#x27;canvas-border&#x27;</span>),
            <span class="hljs-attr">start</span>: [<span class="hljs-string">&#x27;2.5%&#x27;</span>, <span class="hljs-string">&#x27;2.5%&#x27;</span>],
            <span class="hljs-attr">dimensions</span>: [<span class="hljs-string">&#x27;95%&#x27;</span>, <span class="hljs-string">&#x27;95%&#x27;</span>],
            <span class="hljs-attr">lineWidth</span>: <span class="hljs-number">8</span>,
            <span class="hljs-attr">strokeStyle</span>: <span class="hljs-string">&#x27;orange&#x27;</span>,
            <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;draw&#x27;</span>,
            <span class="hljs-attr">order</span>: <span class="hljs-number">1</span>,
        });

        scrawl.<span class="hljs-title function_">makeWheel</span>({
            <span class="hljs-attr">name</span>: <span class="hljs-title function_">name</span>(<span class="hljs-string">&#x27;canvas-blob&#x27;</span>),
            <span class="hljs-attr">start</span>: [<span class="hljs-string">&#x27;center&#x27;</span>, <span class="hljs-string">&#x27;center&#x27;</span>],
            <span class="hljs-attr">handle</span>: [<span class="hljs-string">&#x27;center&#x27;</span>, <span class="hljs-string">&#x27;center&#x27;</span>],
            <span class="hljs-attr">lockTo</span>: <span class="hljs-string">&#x27;mouse&#x27;</span>,
            <span class="hljs-attr">radius</span>: <span class="hljs-string">&#x27;15%&#x27;</span>,
            <span class="hljs-attr">fillStyle</span>: <span class="hljs-string">&#x27;blue&#x27;</span>,
            <span class="hljs-attr">lineWidth</span>: <span class="hljs-number">8</span>,
            <span class="hljs-attr">strokeStyle</span>: <span class="hljs-string">&#x27;red&#x27;</span>,
            <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;fillThenDraw&#x27;</span>,
        });

        scrawl.<span class="hljs-title function_">makeRender</span>({
            <span class="hljs-attr">name</span>: <span class="hljs-title function_">name</span>(<span class="hljs-string">&#x27;animation&#x27;</span>),
            <span class="hljs-attr">target</span>: [stack, canvas],
            <span class="hljs-attr">observer</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">afterCreated</span>: <span class="hljs-function">() =&gt;</span> stack.<span class="hljs-title function_">set</span>({ <span class="hljs-attr">width</span>: <span class="hljs-number">400</span> }),
        });
    }
};

<span class="hljs-keyword">const</span> <span class="hljs-title function_">captureStackIntoLibrary</span> = (<span class="hljs-params">namespace</span>) =&gt; {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;capture the new stack into the library:&#x27;</span>, namespace);

    <span class="hljs-keyword">return</span> scrawl.<span class="hljs-title function_">getStack</span>(namespace);
};

<span class="hljs-keyword">const</span> <span class="hljs-title function_">swapStacks</span> = (<span class="hljs-params"></span>) =&gt; {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;swap the stacks!&#x27;</span>);

    <span class="hljs-keyword">if</span> (currentStack === stack1Namespace) {

        currentStack = stack2Namespace;
        <span class="hljs-title function_">buildStack2</span>(currentStack);
    }
    <span class="hljs-keyword">else</span> {

        currentStack = stack1Namespace;
        <span class="hljs-title function_">buildStack1</span>(currentStack);
    }
};

<span class="hljs-keyword">const</span> <span class="hljs-title function_">reloadStack</span> = (<span class="hljs-params"></span>) =&gt; {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;reload the current stack:&#x27;</span>, currentStack);

    <span class="hljs-keyword">if</span> (currentStack === stack1Namespace) <span class="hljs-title function_">buildStack1</span>(currentStack);
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (currentStack === stack2Namespace) <span class="hljs-title function_">buildStack2</span>(currentStack);
    <span class="hljs-keyword">else</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;nothing to reload&#x27;</span>);
};

<span class="hljs-keyword">const</span> <span class="hljs-title function_">removeStack</span> = (<span class="hljs-params"></span>) =&gt; {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;remove the current stack:&#x27;</span>, currentStack);

    scrawl.<span class="hljs-property">library</span>.<span class="hljs-title function_">purge</span>(currentStack);
    currentStack = noStack;
};</pre></div></div>
            
        </li>
        
        
        <li id="section-38">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-38">&#x00a7;</a>
              </div>
              <p>Initial display</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">const</span> stack1Namespace = <span class="hljs-string">&#x27;my-first-stack&#x27;</span>;
<span class="hljs-keyword">const</span> stack2Namespace = <span class="hljs-string">&#x27;my-second-stack&#x27;</span>;
<span class="hljs-keyword">const</span> noStack = <span class="hljs-string">&#x27;&#x27;</span>;

<span class="hljs-keyword">let</span> currentStack = stack1Namespace;

<span class="hljs-title function_">buildStack1</span>(stack1Namespace);

scrawl.<span class="hljs-title function_">addNativeListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, swapStacks, stackSwitchButton);
scrawl.<span class="hljs-title function_">addNativeListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, reloadStack, stackReplaceButton);
scrawl.<span class="hljs-title function_">addNativeListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, removeStack, stackRemoveButton);</pre></div></div>
            
        </li>
        
        
        <li id="section-39">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-39">&#x00a7;</a>
              </div>
              <h4 id="scene-animation">Scene animation</h4>
<p>Function to display frames-per-second data, and other information relevant to the demo</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">const</span> report = <span class="hljs-title function_">reportSpeed</span>(<span class="hljs-string">&#x27;#reportmessage&#x27;</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">reportFullLibrary</span>(scrawl));</pre></div></div>
            
        </li>
        
        
        <li id="section-40">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-40">&#x00a7;</a>
              </div>
              <p>Create the Display cycle animation</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>scrawl.<span class="hljs-title function_">makeRender</span>({

    <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;report-animation&quot;</span>,
    <span class="hljs-attr">noTarget</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">afterShow</span>: report,
});</pre></div></div>
            
        </li>
        
        
        <li id="section-41">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-41">&#x00a7;</a>
              </div>
              <h4 id="development-and-testing">Development and testing</h4>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(scrawl.<span class="hljs-property">library</span>);</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
