<!DOCTYPE html>

<html>
<head>
  <title>Demo Canvas 019</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="../docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page_wrapper">
            <div id="jump_page">
              
                
                <a class="source" href="canvas-001.html">
                  ./demo/canvas-001.js
                </a>
              
                
                <a class="source" href="canvas-002.html">
                  ./demo/canvas-002.js
                </a>
              
                
                <a class="source" href="canvas-003.html">
                  ./demo/canvas-003.js
                </a>
              
                
                <a class="source" href="canvas-004.html">
                  ./demo/canvas-004.js
                </a>
              
                
                <a class="source" href="canvas-005.html">
                  ./demo/canvas-005.js
                </a>
              
                
                <a class="source" href="canvas-006.html">
                  ./demo/canvas-006.js
                </a>
              
                
                <a class="source" href="canvas-007.html">
                  ./demo/canvas-007.js
                </a>
              
                
                <a class="source" href="canvas-008.html">
                  ./demo/canvas-008.js
                </a>
              
                
                <a class="source" href="canvas-009.html">
                  ./demo/canvas-009.js
                </a>
              
                
                <a class="source" href="canvas-010.html">
                  ./demo/canvas-010.js
                </a>
              
                
                <a class="source" href="canvas-011.html">
                  ./demo/canvas-011.js
                </a>
              
                
                <a class="source" href="canvas-012.html">
                  ./demo/canvas-012.js
                </a>
              
                
                <a class="source" href="canvas-013.html">
                  ./demo/canvas-013.js
                </a>
              
                
                <a class="source" href="canvas-014.html">
                  ./demo/canvas-014.js
                </a>
              
                
                <a class="source" href="canvas-015.html">
                  ./demo/canvas-015.js
                </a>
              
                
                <a class="source" href="canvas-015a.html">
                  ./demo/canvas-015a.js
                </a>
              
                
                <a class="source" href="canvas-016.html">
                  ./demo/canvas-016.js
                </a>
              
                
                <a class="source" href="canvas-017.html">
                  ./demo/canvas-017.js
                </a>
              
                
                <a class="source" href="canvas-018.html">
                  ./demo/canvas-018.js
                </a>
              
                
                <a class="source" href="canvas-019.html">
                  ./demo/canvas-019.js
                </a>
              
                
                <a class="source" href="canvas-019a.html">
                  ./demo/canvas-019a.js
                </a>
              
                
                <a class="source" href="canvas-020.html">
                  ./demo/canvas-020.js
                </a>
              
                
                <a class="source" href="canvas-021.html">
                  ./demo/canvas-021.js
                </a>
              
                
                <a class="source" href="canvas-022.html">
                  ./demo/canvas-022.js
                </a>
              
                
                <a class="source" href="canvas-023.html">
                  ./demo/canvas-023.js
                </a>
              
                
                <a class="source" href="canvas-024.html">
                  ./demo/canvas-024.js
                </a>
              
                
                <a class="source" href="canvas-025.html">
                  ./demo/canvas-025.js
                </a>
              
                
                <a class="source" href="canvas-026.html">
                  ./demo/canvas-026.js
                </a>
              
                
                <a class="source" href="canvas-027.html">
                  ./demo/canvas-027.js
                </a>
              
                
                <a class="source" href="canvas-028.html">
                  ./demo/canvas-028.js
                </a>
              
                
                <a class="source" href="canvas-029.html">
                  ./demo/canvas-029.js
                </a>
              
                
                <a class="source" href="canvas-030.html">
                  ./demo/canvas-030.js
                </a>
              
                
                <a class="source" href="canvas-031.html">
                  ./demo/canvas-031.js
                </a>
              
                
                <a class="source" href="canvas-032.html">
                  ./demo/canvas-032.js
                </a>
              
                
                <a class="source" href="canvas-033.html">
                  ./demo/canvas-033.js
                </a>
              
                
                <a class="source" href="canvas-034.html">
                  ./demo/canvas-034.js
                </a>
              
                
                <a class="source" href="canvas-035.html">
                  ./demo/canvas-035.js
                </a>
              
                
                <a class="source" href="canvas-036.html">
                  ./demo/canvas-036.js
                </a>
              
                
                <a class="source" href="canvas-037.html">
                  ./demo/canvas-037.js
                </a>
              
                
                <a class="source" href="canvas-038.html">
                  ./demo/canvas-038.js
                </a>
              
                
                <a class="source" href="canvas-039.html">
                  ./demo/canvas-039.js
                </a>
              
                
                <a class="source" href="canvas-040.html">
                  ./demo/canvas-040.js
                </a>
              
                
                <a class="source" href="canvas-041.html">
                  ./demo/canvas-041.js
                </a>
              
                
                <a class="source" href="canvas-042.html">
                  ./demo/canvas-042.js
                </a>
              
                
                <a class="source" href="canvas-043.html">
                  ./demo/canvas-043.js
                </a>
              
                
                <a class="source" href="canvas-044.html">
                  ./demo/canvas-044.js
                </a>
              
                
                <a class="source" href="canvas-045.html">
                  ./demo/canvas-045.js
                </a>
              
                
                <a class="source" href="canvas-046.html">
                  ./demo/canvas-046.js
                </a>
              
                
                <a class="source" href="canvas-047.html">
                  ./demo/canvas-047.js
                </a>
              
                
                <a class="source" href="canvas-048.html">
                  ./demo/canvas-048.js
                </a>
              
                
                <a class="source" href="canvas-049.html">
                  ./demo/canvas-049.js
                </a>
              
                
                <a class="source" href="canvas-050.html">
                  ./demo/canvas-050.js
                </a>
              
                
                <a class="source" href="canvas-051.html">
                  ./demo/canvas-051.js
                </a>
              
                
                <a class="source" href="canvas-052.html">
                  ./demo/canvas-052.js
                </a>
              
                
                <a class="source" href="canvas-053.html">
                  ./demo/canvas-053.js
                </a>
              
                
                <a class="source" href="canvas-054.html">
                  ./demo/canvas-054.js
                </a>
              
                
                <a class="source" href="canvas-055.html">
                  ./demo/canvas-055.js
                </a>
              
                
                <a class="source" href="core-001.html">
                  ./demo/core-001.js
                </a>
              
                
                <a class="source" href="delaunator-001.html">
                  ./demo/delaunator-001.js
                </a>
              
                
                <a class="source" href="delaunator-002.html">
                  ./demo/delaunator-002.js
                </a>
              
                
                <a class="source" href="dom-001.html">
                  ./demo/dom-001.js
                </a>
              
                
                <a class="source" href="dom-002.html">
                  ./demo/dom-002.js
                </a>
              
                
                <a class="source" href="dom-003.html">
                  ./demo/dom-003.js
                </a>
              
                
                <a class="source" href="dom-004.html">
                  ./demo/dom-004.js
                </a>
              
                
                <a class="source" href="dom-005.html">
                  ./demo/dom-005.js
                </a>
              
                
                <a class="source" href="dom-006.html">
                  ./demo/dom-006.js
                </a>
              
                
                <a class="source" href="dom-007.html">
                  ./demo/dom-007.js
                </a>
              
                
                <a class="source" href="dom-008.html">
                  ./demo/dom-008.js
                </a>
              
                
                <a class="source" href="dom-009.html">
                  ./demo/dom-009.js
                </a>
              
                
                <a class="source" href="dom-010.html">
                  ./demo/dom-010.js
                </a>
              
                
                <a class="source" href="dom-011.html">
                  ./demo/dom-011.js
                </a>
              
                
                <a class="source" href="dom-012.html">
                  ./demo/dom-012.js
                </a>
              
                
                <a class="source" href="dom-013.html">
                  ./demo/dom-013.js
                </a>
              
                
                <a class="source" href="dom-014a.html">
                  ./demo/dom-014a.js
                </a>
              
                
                <a class="source" href="dom-014b.html">
                  ./demo/dom-014b.js
                </a>
              
                
                <a class="source" href="dom-014c.html">
                  ./demo/dom-014c.js
                </a>
              
                
                <a class="source" href="dom-015.html">
                  ./demo/dom-015.js
                </a>
              
                
                <a class="source" href="dom-016.html">
                  ./demo/dom-016.js
                </a>
              
                
                <a class="source" href="filters-001.html">
                  ./demo/filters-001.js
                </a>
              
                
                <a class="source" href="filters-002.html">
                  ./demo/filters-002.js
                </a>
              
                
                <a class="source" href="filters-002a.html">
                  ./demo/filters-002a.js
                </a>
              
                
                <a class="source" href="filters-003.html">
                  ./demo/filters-003.js
                </a>
              
                
                <a class="source" href="filters-004.html">
                  ./demo/filters-004.js
                </a>
              
                
                <a class="source" href="filters-005.html">
                  ./demo/filters-005.js
                </a>
              
                
                <a class="source" href="filters-006.html">
                  ./demo/filters-006.js
                </a>
              
                
                <a class="source" href="filters-007.html">
                  ./demo/filters-007.js
                </a>
              
                
                <a class="source" href="filters-008.html">
                  ./demo/filters-008.js
                </a>
              
                
                <a class="source" href="filters-009.html">
                  ./demo/filters-009.js
                </a>
              
                
                <a class="source" href="filters-010.html">
                  ./demo/filters-010.js
                </a>
              
                
                <a class="source" href="filters-011.html">
                  ./demo/filters-011.js
                </a>
              
                
                <a class="source" href="filters-012.html">
                  ./demo/filters-012.js
                </a>
              
                
                <a class="source" href="filters-013.html">
                  ./demo/filters-013.js
                </a>
              
                
                <a class="source" href="filters-014.html">
                  ./demo/filters-014.js
                </a>
              
                
                <a class="source" href="filters-015.html">
                  ./demo/filters-015.js
                </a>
              
                
                <a class="source" href="filters-016.html">
                  ./demo/filters-016.js
                </a>
              
                
                <a class="source" href="filters-017.html">
                  ./demo/filters-017.js
                </a>
              
                
                <a class="source" href="filters-018.html">
                  ./demo/filters-018.js
                </a>
              
                
                <a class="source" href="filters-019.html">
                  ./demo/filters-019.js
                </a>
              
                
                <a class="source" href="filters-020.html">
                  ./demo/filters-020.js
                </a>
              
                
                <a class="source" href="filters-021.html">
                  ./demo/filters-021.js
                </a>
              
                
                <a class="source" href="filters-501.html">
                  ./demo/filters-501.js
                </a>
              
                
                <a class="source" href="filters-502.html">
                  ./demo/filters-502.js
                </a>
              
                
                <a class="source" href="filters-503.html">
                  ./demo/filters-503.js
                </a>
              
                
                <a class="source" href="filters-504.html">
                  ./demo/filters-504.js
                </a>
              
                
                <a class="source" href="filters-505.html">
                  ./demo/filters-505.js
                </a>
              
                
                <a class="source" href="mediapipe-001.html">
                  ./demo/mediapipe-001.js
                </a>
              
                
                <a class="source" href="mediapipe-002.html">
                  ./demo/mediapipe-002.js
                </a>
              
                
                <a class="source" href="mediapipe-003.html">
                  ./demo/mediapipe-003.js
                </a>
              
                
                <a class="source" href="modules-001.html">
                  ./demo/modules-001.js
                </a>
              
                
                <a class="source" href="modules-002.html">
                  ./demo/modules-002.js
                </a>
              
                
                <a class="source" href="modules-003.html">
                  ./demo/modules-003.js
                </a>
              
                
                <a class="source" href="packets-001.html">
                  ./demo/packets-001.js
                </a>
              
                
                <a class="source" href="packets-002.html">
                  ./demo/packets-002.js
                </a>
              
                
                <a class="source" href="particles-001.html">
                  ./demo/particles-001.js
                </a>
              
                
                <a class="source" href="particles-002.html">
                  ./demo/particles-002.js
                </a>
              
                
                <a class="source" href="particles-003.html">
                  ./demo/particles-003.js
                </a>
              
                
                <a class="source" href="particles-004.html">
                  ./demo/particles-004.js
                </a>
              
                
                <a class="source" href="particles-005.html">
                  ./demo/particles-005.js
                </a>
              
                
                <a class="source" href="particles-006.html">
                  ./demo/particles-006.js
                </a>
              
                
                <a class="source" href="particles-007.html">
                  ./demo/particles-007.js
                </a>
              
                
                <a class="source" href="particles-008.html">
                  ./demo/particles-008.js
                </a>
              
                
                <a class="source" href="particles-009.html">
                  ./demo/particles-009.js
                </a>
              
                
                <a class="source" href="particles-010.html">
                  ./demo/particles-010.js
                </a>
              
                
                <a class="source" href="particles-011.html">
                  ./demo/particles-011.js
                </a>
              
                
                <a class="source" href="particles-012.html">
                  ./demo/particles-012.js
                </a>
              
                
                <a class="source" href="particles-013.html">
                  ./demo/particles-013.js
                </a>
              
                
                <a class="source" href="particles-014.html">
                  ./demo/particles-014.js
                </a>
              
                
                <a class="source" href="particles-015.html">
                  ./demo/particles-015.js
                </a>
              
                
                <a class="source" href="particles-016.html">
                  ./demo/particles-016.js
                </a>
              
                
                <a class="source" href="snippets-001.html">
                  ./demo/snippets-001.js
                </a>
              
                
                <a class="source" href="snippets-002.html">
                  ./demo/snippets-002.js
                </a>
              
                
                <a class="source" href="snippets-003.html">
                  ./demo/snippets-003.js
                </a>
              
                
                <a class="source" href="snippets-004.html">
                  ./demo/snippets-004.js
                </a>
              
                
                <a class="source" href="temp-001.html">
                  ./demo/temp-001.js
                </a>
              
                
                <a class="source" href="temp-002.html">
                  ./demo/temp-002.js
                </a>
              
                
                <a class="source" href="temp-003.html">
                  ./demo/temp-003.js
                </a>
              
                
                <a class="source" href="temp-inkscapeSvgFilters.html">
                  ./demo/temp-inkscapeSvgFilters.js
                </a>
              
                
                <a class="source" href="tensorflow-001.html">
                  ./demo/tensorflow-001.js
                </a>
              
                
                <a class="source" href="tensorflow-002.html">
                  ./demo/tensorflow-002.js
                </a>
              
            </div>
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-1">&#x00a7;</a>
              </div>
              <h1 id="demo-canvas-019">Demo Canvas 019</h1>
<p>Gradient and Color factories - transparency</p>

            </div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-2">&#x00a7;</a>
              </div>
              <p><a href="../../demo/canvas-019.html">Run code</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">import</span> scrawl <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../source/scrawl.js&#x27;</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-3">&#x00a7;</a>
              </div>
              <h4 id="scene-setup">Scene setup</h4>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">const</span> canvases = scrawl.<span class="hljs-property">library</span>.<span class="hljs-property">canvas</span>,
    entitys = scrawl.<span class="hljs-property">library</span>.<span class="hljs-property">entity</span>,
    c1 = canvases[<span class="hljs-string">&#x27;hackney&#x27;</span>],
    c2 = canvases[<span class="hljs-string">&#x27;heathrow&#x27;</span>],
    c3 = canvases[<span class="hljs-string">&#x27;kingston&#x27;</span>],
    c4 = canvases[<span class="hljs-string">&#x27;burglary&#x27;</span>];</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-4">&#x00a7;</a>
              </div>
              <p>Import the images we defined in the DOM (in &lt;img&gt; elements)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>scrawl.<span class="hljs-title function_">importDomImage</span>(<span class="hljs-string">&#x27;.places&#x27;</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-5">&#x00a7;</a>
              </div>
              <p>For this scene, we’ll build a data structure which we can iterate over, to build the entitys, assets and gradients required by the scene</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">const</span> data = [
    {
        <span class="hljs-attr">canvas</span>: c1,
        <span class="hljs-attr">image</span>: <span class="hljs-string">&#x27;hackney-bg&#x27;</span>,
        <span class="hljs-attr">transparency</span>: <span class="hljs-string">&#x27;transparent&#x27;</span>,
    },
    {
        <span class="hljs-attr">canvas</span>: c2,
        <span class="hljs-attr">image</span>: <span class="hljs-string">&#x27;heathrow-bg&#x27;</span>,
        <span class="hljs-attr">transparency</span>: <span class="hljs-string">&#x27;rgba(0,0,0,0)&#x27;</span>,
    },
    {
        <span class="hljs-attr">canvas</span>: c3,
        <span class="hljs-attr">image</span>: <span class="hljs-string">&#x27;kingston-bg&#x27;</span>,
        <span class="hljs-attr">transparency</span>: <span class="hljs-string">&#x27;#00000000&#x27;</span>,
    },
    {
        <span class="hljs-attr">canvas</span>: c4,
        <span class="hljs-attr">image</span>: <span class="hljs-string">&#x27;burglary-bg&#x27;</span>,
        <span class="hljs-attr">transparency</span>: <span class="hljs-string">&#x27;#0000&#x27;</span>,
    },
];</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-6">&#x00a7;</a>
              </div>
              <p>This array will hold a set of functions which we will invoke in turn at the start of each Display cycle</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">const</span> checkFunctions = [];</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-7">&#x00a7;</a>
              </div>
              <p>The blur filter is temporary - we use it once on each image to generate a blurred version of that image</p>
<ul>
<li>We do it this way because the blur filter is computationally very expensive - capturing a blurred version of the image is a lot better for end user power consumption</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>scrawl.<span class="hljs-title function_">makeFilter</span>({
    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;blur&#x27;</span>,
    <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;gaussianBlur&#x27;</span>,
    <span class="hljs-attr">radius</span>: <span class="hljs-number">20</span>,
});</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-8">&#x00a7;</a>
              </div>
              <p>Iterate through our data array to create Scrawl-canvas objects</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>data.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">scene</span> =&gt;</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-9">&#x00a7;</a>
              </div>
              <p>The original picture, with the blur filter applied to it</p>
<ul>
<li>We will remove the filter in a later step</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">let</span> entity = scrawl.<span class="hljs-title function_">makePicture</span>({

        <span class="hljs-attr">name</span>: <span class="hljs-string">`<span class="hljs-subst">${scene.image}</span>-original`</span>,
        <span class="hljs-attr">group</span>: scene.<span class="hljs-property">canvas</span>.<span class="hljs-property">base</span>.<span class="hljs-property">name</span>,

        <span class="hljs-attr">asset</span>: scene.<span class="hljs-property">image</span>,

        <span class="hljs-attr">dimensions</span>: [<span class="hljs-string">&#x27;100%&#x27;</span>, <span class="hljs-string">&#x27;100%&#x27;</span>],
        <span class="hljs-attr">copyDimensions</span>: [<span class="hljs-string">&#x27;100%&#x27;</span>, <span class="hljs-string">&#x27;100%&#x27;</span>],

        <span class="hljs-attr">filters</span>: [<span class="hljs-string">&#x27;blur&#x27;</span>],
        <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;fill&#x27;</span>,
    });</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-10">&#x00a7;</a>
              </div>
              <p>A one-off instruction to tell Scrawl-canvas to create an image asset from our Picture entity the next time it performs a Display cycle</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    scrawl.<span class="hljs-title function_">createImageFromEntity</span>(entity, <span class="hljs-literal">true</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-11">&#x00a7;</a>
              </div>
              <p>The purpose of this demo is to test the various ways we can define ‘transparency’ in Scrawl-canvas Color objects and Gradients - tests a set of Color factory bugs uncovered and fixed in v8.3.2</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    scrawl.<span class="hljs-title function_">makeRadialGradient</span>({

        <span class="hljs-attr">name</span>: <span class="hljs-string">`<span class="hljs-subst">${scene.image}</span>-gradient`</span>,
        <span class="hljs-attr">start</span>: [<span class="hljs-string">&#x27;50%&#x27;</span>, <span class="hljs-string">&#x27;50%&#x27;</span>],
        <span class="hljs-attr">end</span>: [<span class="hljs-string">&#x27;50%&#x27;</span>, <span class="hljs-string">&#x27;50%&#x27;</span>],
        <span class="hljs-attr">startRadius</span>: <span class="hljs-string">&#x27;5%&#x27;</span>,
        <span class="hljs-attr">endRadius</span>: <span class="hljs-string">&#x27;20%&#x27;</span>,

        <span class="hljs-attr">colors</span>: [
            [<span class="hljs-number">0</span>, scene.<span class="hljs-property">transparency</span>],
            [<span class="hljs-number">999</span>, <span class="hljs-string">&#x27;black&#x27;</span>]
        ],
    });</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-12">&#x00a7;</a>
              </div>
              <p>})
.updateColor(0, <code>${scene.transparency}</code>)
.updateColor(999, ‘black’);</p>

            </div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-13">&#x00a7;</a>
              </div>
              <p>Apply the gradient to the scene via a Block entity</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">const</span> filterBlock = scrawl.<span class="hljs-title function_">makeBlock</span>({

        <span class="hljs-attr">name</span>: <span class="hljs-string">`<span class="hljs-subst">${scene.image}</span>-block`</span>,
        <span class="hljs-attr">group</span>: scene.<span class="hljs-property">canvas</span>.<span class="hljs-property">base</span>.<span class="hljs-property">name</span>,

        <span class="hljs-attr">start</span>: [<span class="hljs-string">&#x27;center&#x27;</span>, <span class="hljs-string">&#x27;center&#x27;</span>],
        <span class="hljs-attr">handle</span>: [<span class="hljs-string">&#x27;center&#x27;</span>, <span class="hljs-string">&#x27;center&#x27;</span>],
        <span class="hljs-attr">dimensions</span>: [<span class="hljs-string">&#x27;200%&#x27;</span>, <span class="hljs-string">&#x27;200%&#x27;</span>],

        <span class="hljs-attr">fillStyle</span>: <span class="hljs-string">`<span class="hljs-subst">${scene.image}</span>-gradient`</span>,
        <span class="hljs-attr">lockFillStyleToEntity</span>: <span class="hljs-literal">true</span>,
    });</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-14">&#x00a7;</a>
              </div>
              <p>Check whether the mouse cursor is hovering over this canvas, and update the filter Block entity’s positioning accordingly</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">const</span> <span class="hljs-title function_">f</span> = (<span class="hljs-params"></span>) =&gt; {

        <span class="hljs-keyword">const</span> here = scene.<span class="hljs-property">canvas</span>.<span class="hljs-property">here</span>,
            block = filterBlock;

        <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {

            block.<span class="hljs-title function_">set</span>({
                <span class="hljs-attr">lockTo</span>: (here.<span class="hljs-property">active</span>) ? <span class="hljs-string">&#x27;mouse&#x27;</span> : <span class="hljs-string">&#x27;start&#x27;</span>,
            });
        }
    };
    checkFunctions.<span class="hljs-title function_">push</span>(<span class="hljs-title function_">f</span>());
});</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-15">&#x00a7;</a>
              </div>
              <p>This function will run once, at the end of the first Display cycle</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">const</span> <span class="hljs-title function_">postInitialization</span> = (<span class="hljs-params">anim</span>) =&gt; {

    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(anim.<span class="hljs-property">target</span>.<span class="hljs-property">name</span>, <span class="hljs-string">&#x27;postInitialization&#x27;</span>)

    <span class="hljs-keyword">let</span> original = entitys[<span class="hljs-string">`<span class="hljs-subst">${anim.target.name}</span>-bg-original`</span>];</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-16">&#x00a7;</a>
              </div>
              <p>Update our original Picture entity, in particular to remove the blur filter and set up its composition in the scene</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    original.<span class="hljs-title function_">set</span>({
        <span class="hljs-attr">filters</span>: [],
        <span class="hljs-attr">order</span>: <span class="hljs-number">2</span>,
        <span class="hljs-attr">globalCompositeOperation</span>: <span class="hljs-string">&#x27;destination-over&#x27;</span>,
    });</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-17">&#x00a7;</a>
              </div>
              <p>Create a second Picture entity using the blurred image asset Scrawl-canvas created for us during the first iteration of the Display cycle.</p>
<ul>
<li>Note that we’ve asked Scrawl-canvas to create an &lt;img&gt; element (outside of the DOM) from our original Picture’s blurred output. Element creation takes time (it’s an asynchronous action), which means that our new Picture entity won’t show up for up to a second after the demo starts running.</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>    original.<span class="hljs-title function_">clone</span>({
        <span class="hljs-attr">name</span>: <span class="hljs-string">`<span class="hljs-subst">${anim.target.name}</span>-bg-blurred`</span>,
        <span class="hljs-attr">asset</span>: <span class="hljs-string">`<span class="hljs-subst">${anim.target.name}</span>-bg-original-image`</span>,
        <span class="hljs-attr">order</span>: <span class="hljs-number">1</span>,
        <span class="hljs-attr">globalCompositeOperation</span>: <span class="hljs-string">&#x27;source-atop&#x27;</span>,
    });
};</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-18">&#x00a7;</a>
              </div>
              <h4 id="scene-animation">Scene animation</h4>
<p>Function to display frames-per-second data, and other information relevant to the demo</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">let</span> report = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {

    <span class="hljs-keyword">let</span> testTicker = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(),
        testTime, testNow, dragging,
        testMessage = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;#reportmessage&#x27;</span>);

    <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {

        testNow = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-19">&#x00a7;</a>
              </div>
              <p>Because we are using the same render object to animate all four canvases, this report function gets run four times for each Display cycle (once each time each canvas is rendered). The fix is to choke the functionality so it actions only after a given number of milliseconds since it was last run - typically 2 milliseconds is enough to ensure the action only runs once per cycle.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> (testNow - testTicker &gt; <span class="hljs-number">2</span>) {

            testTime = testNow - testTicker;
            testTicker = testNow;

            testMessage.<span class="hljs-property">textContent</span> = <span class="hljs-string">`Screen refresh: <span class="hljs-subst">${<span class="hljs-built_in">Math</span>.ceil(testTime)}</span>ms; fps: <span class="hljs-subst">${<span class="hljs-built_in">Math</span>.floor(<span class="hljs-number">1000</span> / testTime)}</span>`</span>;
        }
    };
}();</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-20">&#x00a7;</a>
              </div>
              <p>Create the Display cycle animation</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>scrawl.<span class="hljs-title function_">makeRender</span>({

    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;demo-animation&#x27;</span>,
    <span class="hljs-attr">target</span>: [c1, c2, c3, c4],

    <span class="hljs-attr">afterCreated</span>: postInitialization,
    <span class="hljs-attr">commence</span>: <span class="hljs-function">() =&gt;</span> checkFunctions.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">f</span> =&gt;</span> <span class="hljs-title function_">f</span>()),
    <span class="hljs-attr">afterShow</span>: report,
});</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-21">&#x00a7;</a>
              </div>
              <h4 id="development-and-testing">Development and testing</h4>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(scrawl.<span class="hljs-property">library</span>);</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
